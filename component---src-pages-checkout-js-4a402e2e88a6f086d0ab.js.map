{"version":3,"sources":["webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/StripeCheckoutForm/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/StripeCheckoutForm/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/StripeCheckoutForm/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/StripeCheckout/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/StripeCheckout/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/StripeCheckout/Data.js","webpack:///./src/pages/checkout.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/node_modules/antd/es/layout/index.js"],"names":["Index9","bindings","stripeAddCardForm","rules","data","checkoutForm","hook","ctx","stripe","useStripe","elements","useElements","React","useState","isModalVisible","setIsModalVisible","form","useFormik","initialValues","cardNumber","onSubmit","values","actions","a","cardElement","getElement","CardElement","createPaymentMethod","type","card","billing_details","name","resPaymentMethod","paymentMethodId","fbFnsClient","getClient","post","user_id","apply","payment_id","Error","message","setStatus","error","validationSchema","Yup","shape","required","canSubmit","showModal","handleCancel","handleChange","event","complete","setFieldValue","bindData","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","DIV","className","title","visible","get","onOk","onCancel","okButtonProps","htmlType","id","disabled","loading","okText","FormProvider","options","onChange","Index","Layout","Sider","Content","StripeProvider","StripeCheckoutForm","Data","paymentPage","isLoading","display","notLoading","View","CheckoutIndex","props","location","PageData","SEO","pageData","POS","Header","Footer"],"mappings":"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","file":"component---src-pages-checkout-js-4a402e2e88a6f086d0ab.js","sourcesContent":["import React from 'react';\n\nimport { bindings, hook } from '@vl/redata';\nimport { CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\n\nimport _ from 'lodash';\nimport fbFnsClient from '@vl/mod-clients/fibGatsbyFns';\n\nconst bindData = bindings({\n  stripeAddCardForm: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            checkoutForm: hook((ctx) => {\n              const stripe = useStripe();\n              const elements = useElements();\n              const [isModalVisible, setIsModalVisible] = React.useState(true);\n              const form = useFormik({\n                initialValues: {\n                  cardNumber: '',\n                },\n                onSubmit: async (values, actions) => {\n                  try {\n                    const cardElement = elements.getElement(CardElement);\n\n                    const resPaymentMethod = await stripe.createPaymentMethod({\n                      type: 'card',\n                      card: cardElement,\n                      billing_details: {\n                        name: 'cardholderName',\n                      },\n                    });\n                    const paymentMethodId = _.get(resPaymentMethod, 'paymentMethod.id');\n                    const data = await fbFnsClient.getClient().post('stripe-createSetupIntent', {\n                      user_id: ctx.apply('authModel.getUserId'),\n                      payment_id: paymentMethodId,\n                    });\n                    if (_.get(data, 'errors')) {\n                      throw Error(data.message);\n                    }\n                    if (_.get(data, 'error')) {\n                      throw Error(_.get(data, 'error.message'));\n                    }\n                    setIsModalVisible(false);\n                  } catch (error) {\n                    actions.setStatus({\n                      error,\n                    });\n                  }\n                },\n                validationSchema: Yup.object().shape({\n                  cardNumber: Yup.string().required(ctx.apply('i18n.t', 'Booking.PaymentEditCard.required')),\n                }),\n              });\n              _.assign(form, {\n                isModalVisible,\n                canSubmit: !_.get(form, 'isSubmitting') && _.get(form, 'isValid'),\n                showModal: () => {\n                  setIsModalVisible(true);\n                },\n                handleCancel: () => {\n                  setIsModalVisible(false);\n                },\n                handleChange: async (event) => {\n                  // Listen for changes in the CardElement\n                  // and display any errors as the customer types their card details\n                  // setDisabled(event.empty);\n                  if (event.complete) {\n                    form.setFieldValue('cardNumber', event.complete ? 'complete' : '');\n                  }\n                  form.setStatus({\n                    error: event.error ? event.error.message : '',\n                  });\n                },\n              });\n              return form;\n            }),\n          },\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import View from './View.js';\nimport bindData from './Data.js';\n\nconst Index9 = bindData(View);\nexport default Index9;\n","import React from 'react';\nimport { CardElement } from '@stripe/react-stripe-js';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Modal, Alert } from 'antd';\nimport { Form } from 'formik-antd';\nimport FormProvider from '@uz/unitz-components-web/FormProvider';\n\nexport default function StripeAddCardForm() {\n  // useEffect(() => {\n  //   // Create PaymentIntent as soon as the page loads\n  //   window\n  //     .fetch('/create-payment-intent', {\n  //       method: 'POST',\n  //       headers: {\n  //         'Content-Type': 'application/json',\n  //       },\n  //       body: JSON.stringify({ items: [{ id: 'xl-tshirt' }] }),\n  //     })\n  //     .then((res) => {\n  //       return res.json();\n  //     })\n  //     .then((data) => {\n  //       setClientSecret(data.clientSecret);\n  //     });\n  // }, []);\n\n  const cardStyle = {\n    style: {\n      base: {\n        color: '#32325d',\n        fontFamily: 'Arial, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n        '::placeholder': {\n          color: '#32325d',\n        },\n      },\n      invalid: {\n        color: '#fa755a',\n        iconColor: '#fa755a',\n      },\n    },\n  };\n\n  return (\n    <DIV className=\"stripeAddCardForm\">\n      <Modal\n        title={ctx.apply('i18n.t', 'Payment.Method.newCard')}\n        visible={ctx.get('checkoutForm.isModalVisible')}\n        onOk={ctx.get('checkoutForm.handleSubmit')}\n        onCancel={ctx.get('checkoutForm.handleCancel')}\n        okButtonProps={{\n          type: 'primary',\n          htmlType: 'submit',\n          id: 'submit',\n          disabled: !ctx.get('checkoutForm.canSubmit'),\n          loading: ctx.get('checkoutForm.isSubmitting'),\n          className: 'sm:w-20 sm:h-8 md:w-20 md:h-14 lg:w-20 lg:h-14 xl:w-20 xl:h-14 2xl:w-20 2xl:h-14',\n        }}\n        okText={ctx.apply('i18n.t', 'Payment.Method.newCard')}\n      >\n        {ctx.get('checkoutForm.isModalVisible') && (\n          <FormProvider form={ctx.get('checkoutForm')}>\n            <Form className=\"payment-form\" id=\"payment-form\">\n              <CardElement id=\"card-element\" options={cardStyle} onChange={ctx.get('checkoutForm.handleChange')} />\n              {/* Show any error that happens when processing the payment */}\n              {ctx.get('checkoutForm.status.error') && (\n                <div className=\"py-2\">\n                  <Alert message={ctx.get('checkoutForm.status.error.message')} type=\"error\" />\n                </div>\n              )}\n              {/* Show a success message upon completion */}\n              {/* <p className={ctx.get('checkoutForm.succeeded') ? 'result-message' : 'result-message hidden'}>\n                Payment succeeded, see the result in your\n              </p> */}\n            </Form>\n          </FormProvider>\n        )}\n      </Modal>\n    </DIV>\n  );\n}\n","import React from 'react';\n\nimport DIV from '@vl/redata/DIV.macro';\nimport { Layout } from 'antd';\nimport StripeProvider from '@uz/unitz-providers/StripeProvider';\nimport StripeCheckoutForm from '@uz/unitz-components-web/StripeCheckoutForm';\n\nconst { Sider, Content } = Layout;\nconst Index = () => {\n  // @TODO: validate missing required input\n  return (\n    <StripeProvider>\n      <DIV className=\"stripeCheckout\">\n        <StripeCheckoutForm />\n      </DIV>\n    </StripeProvider>\n  );\n};\n\nexport default Index;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import { bindings, hook } from '@vl/redata';\n\nconst bindData = bindings({\n  paymentPage: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            canSubmit: hook((ctx) => {\n              return ctx.get('form.isValid') && !ctx.get('form.isSubmitting') && ctx.get('form.dirty');\n            }),\n          },\n        },\n      ],\n    ],\n  },\n  isLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n  notLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import React from 'react';\n\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\n\nimport App from '@uz/unitz-app-web/UserApp';\nimport SEO from '@uz/unitz-layout-web/SEO';\n\nimport Layout from '@uz/unitz-layout-web/LayoutMain';\n\nimport Checkout from '@uz/unitz-pages/StripeCheckout';\nimport PageData from '../data/PageDataQuery';\n\nconst CheckoutIndex = (props) => {\n  return (\n    <App>\n      <Layout location={props.location} PageData={PageData}>\n        <DIV>\n          <SEO pageData={ctx.apply('ctf.findPage', { name: 'Homepage' })} />\n          <Layout.POS name=\"app-header\">{ctx.apply('ctf.renderSection', { name: 'articleNavbarSection' })}</Layout.POS>\n          <Layout.POS name=\"app-body\">\n            <div className=\"min-h-full bg-background1\">\n              <div className=\"wrapper app-row\">\n                <Checkout />\n              </div>\n            </div>\n          </Layout.POS>\n          <Layout.POS name=\"app-footer\">{ctx.apply('ctf.renderSection', { name: 'articleFooterSection' })}</Layout.POS>\n        </DIV>\n      </Layout>\n    </App>\n  );\n};\n\nexport default CheckoutIndex;\n","import InternalLayout, { Content, Footer, Header } from './layout';\nimport Sider from './Sider';\nvar Layout = InternalLayout;\nLayout.Header = Header;\nLayout.Footer = Footer;\nLayout.Content = Content;\nLayout.Sider = Sider;\nexport default Layout;"],"sourceRoot":""}