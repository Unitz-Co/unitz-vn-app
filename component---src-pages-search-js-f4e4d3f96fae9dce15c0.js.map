{"version":3,"sources":["webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/SearchPage/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/SearchPage/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/SearchPage/index.js","webpack:///./src/pages/search.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/node_modules/lodash/negate.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/node_modules/lodash/reject.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/redata/RESABLE.js"],"names":["Index","props","DIV","className","HeroSection","RESABLE","ctx","debug","categories","resable","for","get","set","AdvisorSearchForm","Data","bindings","pageContainer","rules","data","hook","useObservableSource","CategoryModel","find","priceRangeOptions","options","min","max","step","defaultValue","advisorSearchForm","route","useRoute","useFormik","initialValues","category","service","priceRange","onSubmit","values","actions","a","minPrice","maxPrice","navigate","to","error","setStatus","validationSchema","Yup","shape","isLoading","display","apply","notLoading","View","SearchIndex","location","PageData","Helmet","title","POS","name","SearchPage","module","exports","predicate","TypeError","args","arguments","length","call","this","arrayFilter","baseFilter","baseIteratee","isArray","negate","collection","Stream","listeners","emit","event","params","map","listener","on","val","concat","proxy","stream","events","dispoers","dis","resolveFunc","fn","children","loading","React","useState","v","$v","ref","useRef","listPromise","listStream","listStreamSubscriber","listObservable","listSubscription","listData","listOpts","disposers","current","useMemo","push","Object","keys","key","item","sub","subscribe","prevData","useEffect","forEach","unsubscribe","resolvePromiseGen","useCallback","index","getAutoKey","prefix","resolver","def","keyId","opts","obj","then","resolvePromise","isObservable","resolveObservable","isStream","resolveStream","next","isIterator"],"mappings":"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","file":"component---src-pages-search-js-f4e4d3f96fae9dce15c0.js","sourcesContent":["import React from 'react';\n\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { resable } from '@vl/redata/RESABLE';\nimport RESABLE from '@vl/redata/RESABLE.macro';\nimport HeroSection from '@uz/unitz-components-web/HeroSection';\nimport AdvisorSearchForm from '@uz/unitz-components-web/AdvisorSearchForm';\n\nconst Index = (props) => {\n  // @TODO: validate missing required input\n  return (\n    <DIV className=\"pageContainer\">\n      <div className=\"relative none-container\">\n        <HeroSection />\n        <div className=\"absolute w-full bottom-12\">\n          <RESABLE>\n            <DIV>\n              {ctx.debug(() => {\n                const categories = resable.for('categories')(ctx.get('categories'), []);\n                ctx.set('categories', categories);\n              })}\n              <AdvisorSearchForm />\n            </DIV>\n          </RESABLE>\n        </div>\n      </div>\n    </DIV>\n  );\n};\n\nexport default Index;\n","import { bindings, hook } from '@vl/redata';\nimport _ from 'lodash';\nimport CategoryModel from '@uz/unitz-models/CategoryModel';\nimport useObservableSource from '@vl/hooks/useObservableSource';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport useRoute from '@vl/hooks/useGbRoute';\n\nconst bindData = bindings({\n  pageContainer: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            categories: hook(() => {\n              const categories = useObservableSource(() => CategoryModel.find('limit: 20', 'id avatar_url display_name'));\n              return categories;\n            }),\n            priceRangeOptions: hook(() => {\n              const options = {\n                min: 100000,\n                max: 5000000\n              };\n              options.step = (options.max - options.min) / 20;\n              options.defaultValue = [options.min + options.step, options.max - options.step];\n\n              return options;\n            }),\n\n            advisorSearchForm: hook((ctx) => {\n              const route = useRoute();\n              const form = useFormik({\n                initialValues: {\n                  category: '',\n                  service: '',\n                  priceRange: ctx.get('priceRangeOptions.defaultValue')\n                },\n                onSubmit: async (values, actions) => {\n                  try {\n                    const { priceRange } = values;\n                    const [minPrice, maxPrice] = priceRange;\n                    route.navigate(\n                      route.to('/filter', {\n                        ..._.omit(values, ['priceRange']),\n                        min: minPrice,\n                        max: maxPrice\n                      })\n                    );\n                  } catch (error) {\n                    actions.setStatus({\n                      error\n                    });\n                  }\n                },\n                validationSchema: Yup.object().shape({})\n              });\n              return form;\n            })\n          }\n        }\n      ]\n    ]\n  },\n  isLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('loadingModel.isLoading'))\n        }\n      ]\n    ]\n  },\n  notLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('loadingModel.isLoading'))\n        }\n      ]\n    ]\n  }\n});\n\nexport default bindData;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import React from 'react';\n\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\n\nimport { Helmet } from 'react-helmet';\n\nimport App from '@uz/unitz-app-web/UserApp';\n\nimport Layout from '@uz/unitz-layout-web/LayoutMain';\n\nimport SearchPage from '@uz/unitz-pages/SearchPage';\nimport PageData from '../data/PageDataQuery';\n\nconst SearchIndex = (props) => {\n  return (\n    <App>\n      <Layout location={props.location} PageData={PageData}>\n        <DIV>\n          <Helmet title={'siteTitle'} />\n          <Layout.POS name=\"app-header\">{ctx.apply('ctf.renderSection', { name: 'articleNavbarSection' })}</Layout.POS>\n          <Layout.POS name=\"app-body\">\n            <SearchPage />\n          </Layout.POS>\n          <Layout.POS name=\"app-footer\">{ctx.apply('ctf.renderSection', { name: 'articleFooterSection' })}</Layout.POS>\n        </DIV>\n      </Layout>\n    </App>\n  );\n};\n\nexport default SearchIndex;\n","/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that negates the result of the predicate `func`. The\n * `func` predicate is invoked with the `this` binding and arguments of the\n * created function.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {Function} predicate The predicate to negate.\n * @returns {Function} Returns the new negated function.\n * @example\n *\n * function isEven(n) {\n *   return n % 2 == 0;\n * }\n *\n * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n * // => [1, 3, 5]\n */\nfunction negate(predicate) {\n  if (typeof predicate != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  return function() {\n    var args = arguments;\n    switch (args.length) {\n      case 0: return !predicate.call(this);\n      case 1: return !predicate.call(this, args[0]);\n      case 2: return !predicate.call(this, args[0], args[1]);\n      case 3: return !predicate.call(this, args[0], args[1], args[2]);\n    }\n    return !predicate.apply(this, args);\n  };\n}\n\nmodule.exports = negate;\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray'),\n    negate = require('./negate');\n\n/**\n * The opposite of `_.filter`; this method returns the elements of `collection`\n * that `predicate` does **not** return truthy for.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.filter\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': false },\n *   { 'user': 'fred',   'age': 40, 'active': true }\n * ];\n *\n * _.reject(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.reject(users, { 'age': 40, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.reject(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.reject(users, 'active');\n * // => objects for ['barney']\n */\nfunction reject(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, negate(baseIteratee(predicate, 3)));\n}\n\nmodule.exports = reject;\n","import React from 'react';\nimport _ from 'lodash';\n\nclass Stream {\n  listeners = {};\n\n  emit(event, ...params) {\n    _.get(this.listeners, [event], []).map((listener) => listener.call(this, ...params));\n  }\n\n  on(event, listener) {\n    _.update(this.listeners, [event], (val) => (val ? val.concat(listener) : [listener]));\n    return () => {\n      _.update(this.listeners, [event], (val) => _.reject(val || [], listener));\n    };\n  }\n\n  proxy(stream, events) {\n    const dispoers = [].concat(events || _.keys(stream.listeners)).map((event) => {\n      return stream.on(event, (...params) => {\n        this.emit(event, ...params);\n      });\n    });\n    return () => dispoers.map((dis) => dis());\n  }\n}\n\nconst resolveFunc = (fn, ...args) => {\n  if (_.isFunction(fn)) {\n    return fn.call(fn, ...args);\n  }\n  return fn;\n};\n\nconst isObservable = (obj) => {\n  return !!obj && typeof obj.subscribe === 'function';\n};\n\nconst isPromise = (obj) => {\n  return !!obj && typeof obj.then === 'function';\n};\n\nconst isStream = (obj) => {\n  return !!obj && typeof obj.on === 'function' && typeof obj.emit === 'function';\n};\n\nconst isIterator = (obj) => {\n  return !!obj && typeof obj.next === 'function';\n};\n\nexport const RESABLE = ({ children, loading }) => {\n  const [v, $v] = React.useState(0);\n\n  const ref = React.useRef({\n    loading: false,\n\n    listPromise: {},\n\n    listStream: {},\n    listStreamSubscriber: {},\n\n    listObservable: {},\n    listSubscription: {},\n\n    listData: {},\n    listOpts: {},\n\n    stream: new Stream(),\n    disposers: []\n  });\n\n  _.assign(ref.current, { v, $v });\n\n  React.useMemo(() => {\n    ref.current.disposers\n      && ref.current.disposers.push(\n        ref.current.stream.on(\n          'resolve',\n          _.debounce(async () => {\n            ref.current.loading = true;\n\n            // for listPromise\n            if (ref.current.listPromise) {\n              for (const key of Object.keys(ref.current.listPromise)) {\n                if (!_.has(ref.current.listData, key)) {\n                  let item = ref.current.listPromise[key];\n                  item = await resolveFunc(item);\n                  _.set(ref.current.listData, key, item);\n                }\n              }\n            }\n\n            // for listObservable\n            if (ref.current.listObservable) {\n              for (const key of Object.keys(ref.current.listObservable)) {\n                if (!_.has(ref.current.listSubscription, key)) {\n                  const item = ref.current.listObservable[key];\n                  const sub = item.subscribe((val) => {\n                    _.set(ref.current.listData, key, val);\n                    ref.current.stream && ref.current.stream.emit('changed');\n                  });\n                  _.set(ref.current.listSubscription, key, sub);\n                }\n              }\n            }\n\n            // for listStream\n            if (ref.current.listStream) {\n              for (const key of Object.keys(ref.current.listStream)) {\n                if (!_.has(ref.current.listStreamSubscriber, key)) {\n                  const item = ref.current.listStream[key];\n                  const event = _.get(ref.current.listOpts, [key, 'event'], 'data');\n                  const sub = item.on(event, (val) => {\n                    _.set(ref.current.listData, key, val);\n                    ref.current.stream && ref.current.stream.emit('changed');\n                  });\n                  _.set(ref.current.listStreamSubscriber, key, sub);\n                }\n              }\n            }\n\n            ref.current.loading = false;\n            ref.current.stream && ref.current.stream.emit('changed');\n          })\n        )\n      );\n\n    ref.current.disposers\n      && ref.current.disposers.push(\n        ref.current.stream.on(\n          'changed',\n          _.debounce(async () => {\n            if (!_.isEqual(ref.current.prevData, ref.current.listData)) {\n              ref.current.prevData = _.cloneDeep(ref.current.listData);\n              ref.current.$v && ref.current.$v(ref.current.v + 1);\n            }\n          })\n        )\n      );\n  }, []);\n\n  React.useEffect(() => {\n    return () => {\n      ref.current.disposers && ref.current.disposers.forEach((dis) => dis());\n\n      // unsubscribe subscriptions\n      ref.current.listSubscription && _.map(ref.current.listSubscription, (sub) => sub && sub.unsubscribe);\n\n      // disposer stream listener\n      ref.current.listStreamSubscriber\n        && _.map(ref.current.listStreamSubscriber, (sub) => {\n          return sub && sub();\n        });\n\n      ref.current = {};\n    };\n  }, []);\n\n  const resolvePromiseGen = React.useCallback(() => {\n    let index = 0;\n    const getAutoKey = (prefix = 'auto') => {\n      index++;\n      return `${prefix}_${index}`;\n    };\n    const resolvePromise = (data, def, keyId, opts) => {\n      const key = keyId || getAutoKey('promise');\n      ref.current.listPromise && _.set(ref.current.listPromise, key, data);\n      ref.current.listOpts && _.set(ref.current.listOpts, key, opts);\n      ref.current.stream && ref.current.stream.emit('resolve', key);\n      return _.get(ref.current.listData, key, def);\n    };\n\n    const resolveObservable = (data, def, keyId, opts) => {\n      const key = keyId || getAutoKey('observable');\n      ref.current.listObservable && _.set(ref.current.listObservable, key, data);\n      ref.current.listOpts && _.set(ref.current.listOpts, key, opts);\n      ref.current.stream && ref.current.stream.emit('resolve', key);\n      return _.get(ref.current.listData, key, def);\n    };\n\n    const resolveStream = (data, def, keyId, opts) => {\n      const key = keyId || getAutoKey('stream');\n      ref.current.listStream && _.set(ref.current.listStream, key, data);\n      ref.current.listOpts && _.set(ref.current.listOpts, key, opts);\n      ref.current.stream && ref.current.stream.emit('resolve', key);\n      return _.get(ref.current.listData, key, def);\n    };\n\n    const resolver = (data, def, keyId, opts) => {\n      if (isPromise(data)) {\n        // console.log('resolving promise')\n        return resolvePromise(data, def, keyId, opts);\n      } if (isObservable(data)) {\n        // console.log('resolving observable', data);\n        return resolveObservable(data, def, keyId, opts);\n      } if (isStream(data)) {\n        // console.log('resolving stream', data);\n        return resolveStream(data, def, keyId, opts);\n      } if (isIterator(data)) {\n        // console.log('resolving iterator', data);\n        return def;\n      }\n      // console.log('not resolveable data')\n      return data;\n      // return def;\n    };\n\n    resolver.for = (keyId, opts) => (data, def) => resolver(data, def, keyId, opts);\n\n    return resolver;\n  }, []);\n\n  if (ref.current.loading) {\n    return resolveFunc(loading) || null;\n  }\n\n  return resolveFunc(children, resolvePromiseGen());\n};\n\nexport const resable = () => {};\n\nexport default RESABLE;\n"],"sourceRoot":""}