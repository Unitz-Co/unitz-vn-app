{"version":3,"sources":["webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallFinish.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallMissed.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallRejected.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallEarlyEnd.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/CallCompleted/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/CallCompleted/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/CallCompleted/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallConnecting.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallIniting.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallOnProgress.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/PublisherHandler.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/VideoCallSession.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/components/SectionVideoCallActions.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-models/VideoCallWebModel/constants.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-models/VideoCallWebModel/VideoCallState.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-models/VideoCallWebModel/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-components-web/VideoCall/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/VideoCall/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-models/VideoCallWebModel/formatter.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/VideoCall/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/VideoCall/index.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/ServiceSession/View.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/ServiceSession/Data.js","webpack:////Volumes/Data/working/Unitz/ws-app-web/modules/unitz-pages/ServiceSession/index.js","webpack:///./src/templates/videocall/index.js"],"names":["FinishLayout","styled","div","gstyles","colors","sub","Triagle","attrs","props","halfSize","size","color","border","View8","DIV","className","Avatar","src","ctx","get","apply","count","value","onChange","num","toString","TextArea","rows","placeholder","e","Button","onClick","disabled","loading","type","block","name","ghost","icons","fill","brandb500","icon","number","Index","VideoCallFinish","VideoCallMissed","VideoCallRejected","RatingFlatform","VideoCallEarlyEnd","Data","bindings","pageContainer","rules","data","transaction","hook","session_id","useRoute","useObservableSource","TransactionModel","find","transactionData","transactions","useSubjectSource","statusLatest","TransactionFormatter","callPackageTimeMinute","AdvisorFormatter","callPackage","callPackageTime","callPackagePrice","callPackageTotal","purchaseData","purchase_id","usePromiseSource","a","PurchaseModel","purchase","toObject","advisorService","advisor","service","advisorProfile","reviewAggregate","bill","CFAdvisorProfileFormatter","amountPayment","displayName","AdvisorProfileFormatter","avatarUrl","rating","ratingText","reviewText","ratingScore","reviewScore","reviewCount","status","PurchaseFormatter","getStatus","totalAfter","formatVND","totalBefore","discount","form","advisor_id","user_id","useFormik","initialValues","note","onSubmit","values","AdvisorReviewModel","create","target_id","review_text","score","created_by","console","log","validationSchema","Yup","shape","required","canSubmit","page","React","useState","$rating","useEffect","handlers","ratingFinish","isLoading","display","notLoading","completedSuccess","completeStatus","completedMissed","completedRejected","completedEarlyEnd","completedRating","View","white500","RefreshInterval","interval","DraggableHandle","PublisherHandler","children","Responsive","sm","normal","top","right","width","height","collapse","md","lg","resProps","stopPropagation","style","position","zIndex","bottom","axis","handle","defaultPosition","x","y","grid","scale","onDrag","onStop","bounds","left","cx","OTSession","Loadable","OTPublisher","OTStreams","OTSubscriber","areEqual","prevProps","nextProps","layout","CallSession","memo","videoCallModel","window","forceCtx","properties","showControls","cameraPosition","publishAudio","publishVideo","eventHandlers","error","args","otrnError","MenuSetting","map","index","rest","key","ControlButton","text","horizontal","disable","visible","overlay","placement","trigger","main","background","VideoCallSession","VideoCallIniting","VideoCallConnecting","VideoCallOnProgress","INTERNET_STATES","connected","reconnecting","disconnect","VideoCallState","_local","id","Object","assign","this","states","videoCallConnecting","sessionData","peerStates","micMute","videoMute","internetStatus","onConnect","state","once","connectFirestore","docId","collectionName","uid","oid","userId","advisorId","EventType","InstanceMap","items","add","instance","VideoCallModel","callState","CALL_STATES","videoCallIniting","startTime","msg","remoteState","localState","constructor","initState","stream","Stream","set","resolvers","user","on","notifTimer","setTimeout","emit","clearTimeout","hasCallState","videoCallTaking","startCall","startTimer","getCallState","getState","videoCallFinish","setState","endTime","moment","isMounted","stopNotifySession","videoCallIncomming","opts","instances","fromMessage","service_id","connectStore","fromSession","createSession","fromCall","callData","err","enhance","getSectionId","getSectionToken","getSectionKey","params","fbFnsClient","getClient","post","notifySession","notifId","watchNotifTimeout","watcherKey","docRef","fibApp","firestore","collection","doc","disposers","push","onSnapshot","docData","dis","splice","length","switchCamera","cameraPositions","newPos","toggleMic","toggleVideo","toggleVideoSubscriber","collapseVideo","separateVideo","reConnecting","reConnected","disConnected","isConnected","isConnecting","isDisconnected","videoCallOnProgress","takeCall","valueOf","endCall","startIncomingCall","rejectCall","getCallDuration","now","duration","diff","durationFormatter","asMilliseconds","getCallDurationTotal","format","getCallMaxDuration","durationSecondsStr","onForegroundEvent","ev","detail","ACTION_PRESS","action","handler","onBackgroundEvent","pressAction","BaseModel","videoCallReject","videoComponent","videoCallOnProgressOffCamera","videoCallDisconnect","sessionReconnect","callSession","ref","VideoCall","SectionVideoCallActions","formatter","getTokboxConfig","apiKey","sessionId","token","signal","to","sessionConnected","sessionDisconnected","connectionId","sessionReconnected","sessionReconnecting","streamCreated","streamDestroyed","connectionCreated","connectionDestroyed","getTokboxSubscriberConfig","videoDisabled","videoEnabled","CONTROL_BAR_STATUS","videoPage","route","routeParams","useMemo","hookState","tokbox","voiceCallModel","VideoCallFormatter","tokboxSubscriber","AdvisorModel","profile","item","profileId","price","pricePerMinTxt","pricePerMin","pricePerMinTitle","isCalling","visibleDropdown","$visibleDropdown","smartGesture","controlBarStatus","$controlBarStatus","swap","$swap","dragging","$dragging","slideUp","$touchScreen","$touchSmallScreen","onStopDrag","onCompleted","step","toUrl","redirectUrl","origin","navigate","relace","setRouteState","price_amount","discounts","sectionVideoActions","Payment","PaymentConfirm","CallCompleted","STEP_LIST","STEP_LIST_BY_NAME","val","serviceSessionPage","stepModel","currentStep","$currentStep","setStep","newStep","hasNext","nextStep","prevStep","callAgain","undefined","callFinish","navigateExternal","paymentStep","confirmStep","serviceStep","completedStep","component","withPageContext","location","PageData","SEO","pageData","POS","ServiceSession"],"mappings":"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","file":"component---src-templates-videocall-index-js-b8a4c5d76d987b1c0e59.js","sourcesContent":["import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Input, Rate } from 'antd';\nimport { Button } from '@uz/unitz-components-web/Button';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\n\nimport gstyles from '@vl/gstyles';\nimport styled from 'styled-components';\nimport _ from 'lodash';\n\nconst FinishLayout = styled.div`\n  padding: 0 16px;\n  textarea.ant-input {\n    font-size: 16px;\n  }\n  textarea.ant-input::placeholder {\n    color: ${gstyles.colors.sub};\n    font-size: 16px;\n  }\n  .ant-input {\n    padding: 0.5rem 0.75rem;\n    border-radius: 0.5rem;\n    --tw-border-opacity: 1;\n    border-color: rgba(191, 205, 217, var(--tw-border-opacity));\n  }\n`;\nconst Triagle = styled.div.attrs((props) => ({\n  halfSize: props.size ? `${props.size / 2}px` : '5px',\n  size: props.size ? `${props.size}px` : '10px',\n  color: props.color ? props.color : gstyles.colors.border,\n}))`\n  position: relative;\n  overflow: hidden;\n  transform: translateY(50%) rotate(45deg) skewY(45deg) scaleX(0.5);\n  pointer-events: none;\n  & {\n    width: ${(props) => props.size};\n    height: ${(props) => props.size};\n  }\n\n  &::before,\n  &::after {\n    width: ${(props) => props.size};\n    height: ${(props) => props.size};\n  }\n  &::before,\n  &::after {\n    content: '';\n    position: absolute;\n    background: ${(props) => props.color};\n    pointer-events: auto;\n  }\n  &::before {\n    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) skewX(30deg) scaleY(0.866) translateX(-24%);\n  }\n  &::after {\n    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) skewX(-30deg) scaleY(0.866) translateX(24%);\n  }\n\n  border-radius: 20%;\n  &::before {\n    border-radius: 20% 20% 20% 55%;\n  }\n\n  &::after {\n    border-radius: 20% 20% 55% 20%;\n  }\n  textarea::-webkit-resizer {\n    display: none;\n  }\n`;\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallFinish\">\n      {/* <Modal\n        className=\"pb-0 overflow-hidden rounded-xl\"\n        style={{ borderRadius: 12 }}\n        bodyStyle={{ padding: 0 }}\n        width={600}\n        footer={null}\n        visible={true}\n        closable={false}\n      > */}\n      <FinishLayout>\n        <section className=\"py-0 bg-white min-lg:w-150 max-w-150 rounded-xl\">\n          <div className=\"flex flex-col items-center p-6\">\n            <div className=\"flex items-center\">\n              <Avatar src={ctx.get('purchaseData.advisorProfile.avatarUrl')} size={32} />\n              <h1 className=\"mb-0 ml-2 text-base text-main\">{ctx.get('purchaseData.advisorProfile.displayName')}</h1>\n            </div>\n            <p className=\"mt-4 mb-3 text-base font-normal\">{ctx.apply('i18n.t', 'AdvisorVideoCall.finishDesc')}</p>\n            <Rate\n              count={5}\n              value={ctx.get('form.values.rating')}\n              onChange={(num) => ctx.apply('form.handleChange', 'rating')(num.toString())}\n            />\n            <label className=\"mt-2 text-center text-main\">\n              {ctx.apply('i18n.t', `RatingSuggestion.label${ctx.get('form.values.rating')}`)}\n            </label>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col p-6 pb-0\">\n            <label className=\"mb-2 text-base\">{ctx.apply('i18n.t', 'AdvisorVideoCall.userReaction')}</label>\n            <div className=\"relative\">\n              <Input.TextArea\n                rows={3}\n                value={ctx.get('form.values.note')}\n                placeholder={ctx.apply('i18n.t', 'AdvisorVideoCall.finishNote')}\n                onChange={(e) => ctx.apply('form.handleChange', 'note')(_.get(e, 'target.value', ''))}\n              ></Input.TextArea>\n              <div className=\"absolute p-1 rounded-lg pointer-events-none right-1px bottom-1px bg-white500\">\n                <Triagle className=\"\" size={10} color={gstyles.colors.border} />\n              </div>\n            </div>\n          </div>\n          <div className=\"flex flex-col justify-between p-6 space-y-4\">\n            <Button\n              onClick={ctx.get('form.submitForm')}\n              size=\"large\"\n              disabled={!ctx.get('canSubmit')}\n              loading={ctx.get('form.isSubmitting')}\n              type=\"primary\"\n              block\n            >\n              {ctx.apply('i18n.t', 'AdvisorVoiceCall.finishReview')}\n            </Button>\n            <Button onClick={ctx.get('stepModel.handlers.callFinish')} size=\"large\" type=\"text\" name=\"ink\" ghost block>\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.exit')}\n            </Button>\n          </div>\n        </section>\n      </FinishLayout>\n      {/* </Modal> */}\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Rate } from 'antd';\nimport { Button } from '@uz/unitz-components-web/Button';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\n\nimport gstyles from '@vl/gstyles';\nimport styled from 'styled-components';\n\nconst FinishLayout = styled.div`\n  padding: 0 16px;\n  textarea.ant-input {\n    font-size: 16px;\n  }\n  textarea.ant-input::placeholder {\n    color: ${gstyles.colors.sub};\n    font-size: 16px;\n  }\n  .ant-input {\n    padding: 0.5rem 0.75rem;\n    border-radius: 0.5rem;\n    --tw-border-opacity: 1;\n    border-color: rgba(191, 205, 217, var(--tw-border-opacity));\n  }\n`;\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallMissed\">\n      {/* <Modal\n        className=\"pb-0 overflow-hidden rounded-xl\"\n        style={{ borderRadius: 12 }}\n        bodyStyle={{ padding: 0 }}\n        width={600}\n        footer={null}\n        visible={true}\n        closable={false}\n      > */}\n      <FinishLayout>\n        <section className=\"py-0 bg-white min-lg:w-150 max-w-150 rounded-xl\">\n          <div className=\"flex flex-col items-center min-lg:p-6 max-lg:py-6\">\n            <h2 className=\"mb-1 text-xl text-main\">{ctx.apply('i18n.t', 'AdvisorVoiceCall.callStatus.missedLabel')}</h2>\n            <div className=\"flex mt-1\">\n              {gstyles.icons({\n                name: 'videocam',\n                fill: gstyles.colors.brandb500,\n                size: 24,\n                className: 'mr-2',\n              })}\n              <p className=\"mb-0 text-base font-normal text-main\">{ctx.get('purchaseData.bill.totalAfter')}</p>\n            </div>\n            <div className=\"flex items-center justify-between w-full px-4 mt-4 min-lg:py-2 max-lg:py-1 min-lg:rounded-xl bg-red-lightest\">\n              <span className=\"text-sub\">{ctx.apply('i18n.t', 'AdvisorVideoCall.missCallText')}</span>\n              <Button\n                onClick={ctx.get('stepModel.handlers.callAgain')}\n                icon={gstyles.icons({\n                  name: 'videocam',\n                  size: 22,\n                  className: 'inline-block mr-2',\n                })}\n                type=\"link\"\n                name=\"red\"\n              >\n                {ctx.apply('i18n.t', 'AdvisorVideoCall.reCall')}\n              </Button>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col items-center p-6\">\n            <div className=\"flex items-center\">\n              <Avatar src={ctx.get('purchaseData.advisorProfile.avatarUrl')} size={80} />\n              <div className=\"flex flex-col ml-5\">\n                <h1 className=\"mb-1 text-xl font-medium\">{ctx.get('purchaseData.advisorProfile.displayName')}</h1>\n                <div className=\"flex items-center mb-1\">\n                  <div className=\"mr-2 -mb-1 text-base\">{ctx.get('purchaseData.advisorProfile.rating.ratingText')}</div>\n                  <Rate disabled count={5} value={ctx.get('purchaseData.advisorProfile.rating.ratingScore')} />\n                </div>\n                <div className=\"mb-2 uppercase text-sub text-xxs\">\n                  {ctx.get('purchaseData.advisorProfile.reviewCount')} {ctx.apply('i18n.t', 'Payment.Profile.reviews')}\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-row justify-between p-6 space-x-4\">\n            <Button onClick={ctx.get('stepModel.handlers.callFinish')} size=\"large\" type=\"primary\" block>\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.finishSend')}\n            </Button>\n          </div>\n        </section>\n      </FinishLayout>\n      {/* </Modal> */}\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Rate } from 'antd';\nimport { Button } from '@uz/unitz-components-web/Button';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\n\nimport gstyles from '@vl/gstyles';\nimport styled from 'styled-components';\n\nconst FinishLayout = styled.div`\n  padding: 0 16px;\n  textarea.ant-input {\n    font-size: 16px;\n  }\n  textarea.ant-input::placeholder {\n    color: ${gstyles.colors.sub};\n    font-size: 16px;\n  }\n  .ant-input {\n    padding: 0.5rem 0.75rem;\n    border-radius: 0.5rem;\n    --tw-border-opacity: 1;\n    border-color: rgba(191, 205, 217, var(--tw-border-opacity));\n  }\n`;\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallRejected\">\n      {/* <Modal\n        className=\"pb-0 overflow-hidden rounded-xl\"\n        style={{ borderRadius: 12 }}\n        bodyStyle={{ padding: 0 }}\n        width={600}\n        footer={null}\n        visible={true}\n        closable={false}\n      > */}\n      <FinishLayout>\n        <section className=\"py-0 bg-white min-lg:w-150 max-w-150 rounded-xl\">\n          <div className=\"flex flex-col items-center min-lg:p-6 max-lg:py-6\">\n            <h2 className=\"mb-1 text-xl text-main\">\n              {ctx.apply('i18n.t', 'AdvisorVoiceCall.callStatus.declinedLabel')}\n            </h2>\n            <div className=\"flex mt-1\">\n              {gstyles.icons({\n                name: 'videocam',\n                fill: gstyles.colors.brandb500,\n                size: 24,\n                className: 'mr-2',\n              })}\n              <p className=\"mb-0 text-base font-normal text-main\">{ctx.get('purchaseData.bill.totalAfter')}</p>\n            </div>\n            <p className=\"mt-2 mb-0 mr-2 text-4xl text-main\">{ctx.apply('videoCallModel.getCallDurationTotal', '')}</p>\n            <div className=\"flex items-center justify-between w-full px-4 py-2 mt-4 min-lg:rounded-xl bg-red-lightest\">\n              <span className=\"text-sub\">{ctx.apply('i18n.t', 'AdvisorVoiceCall.rejectCallText')}</span>\n              <Button\n                onClick={ctx.get('stepModel.handlers.callAgain')}\n                icon={gstyles.icons({\n                  name: 'videocam',\n                  size: 22,\n                  className: 'inline-block mr-2',\n                })}\n                type=\"link\"\n                name=\"red\"\n              >\n                {ctx.apply('i18n.t', 'AdvisorVideoCall.reCall')}\n              </Button>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col items-center p-6\">\n            <div className=\"flex items-center\">\n              <Avatar src={ctx.get('purchaseData.advisorProfile.avatarUrl')} size={80} />\n              <div className=\"flex flex-col ml-5\">\n                <h1 className=\"mb-1 text-xl font-medium\">{ctx.get('purchaseData.advisorProfile.displayName')}</h1>\n                <div className=\"flex items-center mb-1\">\n                  <div className=\"mr-2 -mb-1 text-base\">{ctx.get('purchaseData.advisorProfile.rating.ratingText')}</div>\n                  <Rate disabled count={5} value={ctx.get('purchaseData.advisorProfile.rating.ratingScore')} />\n                </div>\n                <div className=\"mb-2 uppercase text-sub text-xxs\">\n                  {ctx.get('purchaseData.advisorProfile.reviewCount')} {ctx.apply('i18n.t', 'Payment.Profile.reviews')}\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-row justify-between p-6 space-x-4\">\n            <Button onClick={ctx.get('stepModel.handlers.callFinish')} size=\"large\" type=\"primary\" block>\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.finishSend')}\n            </Button>\n          </div>\n        </section>\n      </FinishLayout>\n      {/* </Modal> */}\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Input, Rate } from 'antd';\nimport { Button } from '@uz/unitz-components-web/Button';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\nimport gstyles from '@vl/gstyles';\nimport styled from 'styled-components';\nimport _ from 'lodash';\n\nconst FinishLayout = styled.div`\n  padding: 0 16px;\n  textarea.ant-input {\n    font-size: 16px;\n  }\n  textarea.ant-input::placeholder {\n    color: ${gstyles.colors.sub};\n    font-size: 16px;\n  }\n  .ant-input {\n    padding: 0.5rem 0.75rem;\n    border-radius: 0.5rem;\n    --tw-border-opacity: 1;\n    border-color: rgba(191, 205, 217, var(--tw-border-opacity));\n  }\n`;\nconst Triagle = styled.div.attrs((props) => ({\n  halfSize: props.size ? `${props.size / 2}px` : '5px',\n  size: props.size ? `${props.size}px` : '10px',\n  color: props.color ? props.color : gstyles.colors.border,\n}))`\n  position: relative;\n  overflow: hidden;\n  transform: translateY(50%) rotate(45deg) skewY(45deg) scaleX(0.5);\n  pointer-events: none;\n  & {\n    width: ${(props) => props.size};\n    height: ${(props) => props.size};\n  }\n\n  &::before,\n  &::after {\n    width: ${(props) => props.size};\n    height: ${(props) => props.size};\n  }\n  &::before,\n  &::after {\n    content: '';\n    position: absolute;\n    background: ${(props) => props.color};\n    pointer-events: auto;\n  }\n  &::before {\n    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) skewX(30deg) scaleY(0.866) translateX(-24%);\n  }\n  &::after {\n    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) skewX(-30deg) scaleY(0.866) translateX(24%);\n  }\n\n  border-radius: 20%;\n  &::before {\n    border-radius: 20% 20% 20% 55%;\n  }\n\n  &::after {\n    border-radius: 20% 20% 55% 20%;\n  }\n  textarea::-webkit-resizer {\n    display: none;\n  }\n`;\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallRejected\">\n      {/* <Modal\n        className=\"pb-0 overflow-hidden rounded-xl\"\n        style={{ borderRadius: 12 }}\n        bodyStyle={{ padding: 0 }}\n        width={600}\n        footer={null}\n        visible={true}\n        closable={false}\n      > */}\n      <FinishLayout>\n        <section className=\"py-0 bg-white min-lg:w-150 max-w-150 rounded-xl\">\n          <div className=\"flex flex-col items-center min-lg:p-6 max-lg:py-6\">\n            <h2 className=\"mb-1 text-xl text-main\">\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.callStatus.earlyEndLabel')}\n            </h2>\n            <div className=\"flex mt-1\">\n              {gstyles.icons({\n                name: 'videocam',\n                fill: gstyles.colors.brandb500,\n                size: 24,\n                className: 'mr-2',\n              })}\n              <p className=\"mb-0 text-base font-normal text-main\">{ctx.get('purchaseData.bill.totalAfter')}</p>\n            </div>\n            <p className=\"mt-2 mb-0 mr-2 text-4xl text-main\">{ctx.get('transactionData.callPackageTime')}</p>\n            <div className=\"flex items-center justify-between w-full px-4 mt-4 min-lg:py-2 max-lg:py-1 min-lg:rounded-xl bg-red-lightest\">\n              <span className=\"text-sub\">{ctx.apply('i18n.t', 'AdvisorVideoCall.earlyEndCallText')}</span>\n              <Button\n                onClick={ctx.get('stepModel.handlers.callAgain')}\n                icon={gstyles.icons({\n                  name: 'videocam',\n                  size: 22,\n                  className: 'inline-block mr-2',\n                })}\n                type=\"link\"\n                name=\"red\"\n              >\n                {ctx.apply('i18n.t', 'AdvisorVideoCall.reCall')}\n              </Button>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col items-center p-6\">\n            <div className=\"flex items-center\">\n              <Avatar src={ctx.get('purchaseData.advisorProfile.avatarUrl')} size={32} />\n              <h1 className=\"mb-0 ml-2 text-base text-main\">{ctx.get('purchaseData.advisorProfile.displayName')}</h1>\n            </div>\n            <p className=\"mt-4 mb-3 text-base font-normal text-center\">\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.finishDesc')}\n            </p>\n            <Rate\n              count={5}\n              value={ctx.get('form.values.rating')}\n              onChange={(number) => {\n                ctx.apply('form.handleChange', 'rating')(number.toString());\n              }}\n            />\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col p-6 pb-0\">\n            <label className=\"mb-2 text-base\">{ctx.apply('i18n.t', 'AdvisorVideoCall.userReaction')}</label>\n            <div className=\"relative\">\n              <Input.TextArea\n                rows={3}\n                value={ctx.get('form.values.note')}\n                placeholder={ctx.apply('i18n.t', 'AdvisorVideoCall.finishNote')}\n                onChange={(e) => ctx.apply('form.handleChange', 'note')(_.get(e, 'target.value', ''))}\n              ></Input.TextArea>\n              <div className=\"absolute p-1 rounded-lg pointer-events-none right-1px bottom-1px bg-white500\">\n                <Triagle className=\"\" size={10} color={gstyles.colors.border} />\n              </div>\n            </div>\n          </div>\n          <div className=\"flex flex-row justify-between p-6 space-x-4\">\n            <Button\n              onClick={ctx.get('form.submitForm')}\n              size=\"large\"\n              disabled={!ctx.get('canSubmit')}\n              loading={ctx.get('form.isSubmitting')}\n              type=\"primary\"\n              block\n            >\n              {ctx.apply('i18n.t', 'AdvisorVoiceCall.finishReview')}\n            </Button>\n            <Button onClick={ctx.get('stepModel.handlers.callFinish')} size=\"large\" type=\"primary\" block>\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.finishSend')}\n            </Button>\n          </div>\n        </section>\n      </FinishLayout>\n      {/* </Modal> */}\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport DIV from '@vl/redata/DIV.macro';\nimport VideoCallFinish from '@uz/unitz-components-web/VideoCall/components/VideoCallFinish';\nimport VideoCallMissed from '@uz/unitz-components-web/VideoCall/components/VideoCallMissed';\nimport VideoCallRejected from '@uz/unitz-components-web/VideoCall/components/VideoCallRejected';\nimport VideoCallEarlyEnd from '@uz/unitz-components-web/VideoCall/components/VideoCallEarlyEnd';\nimport RatingFlatform from '@uz/unitz-pages/RatingFlatform';\n\nconst Index = () => {\n  return (\n    <DIV className=\"pageContainer\">\n      <div className=\"fixed top-0 left-0 z-10 flex items-center justify-center w-screen h-screen bg-main\">\n        <DIV className=\"completedSuccess\">\n          <VideoCallFinish />\n        </DIV>\n        <DIV className=\"completedMissed\">\n          <VideoCallMissed />\n        </DIV>\n        <DIV className=\"completedRejected\">\n          <VideoCallRejected />\n        </DIV>\n        <DIV className=\"completedRating\">\n          <RatingFlatform />\n        </DIV>\n        <DIV className=\"completedEarlyEnd\">\n          <VideoCallEarlyEnd />\n        </DIV>\n      </div>\n      {/* <DIV>\n        <RESABLE>\n          {ctx.debug(() => {\n            const transaction = resable.for('transaction')(ctx.get('transaction'), []);\n            ctx.set('transaction', transaction);\n          })}\n          <CallCompleted />\n        </RESABLE>\n      </DIV> */}\n      {/* <div className=\"flex justify-center\">\n        <section className=\"py-0 w-150\">\n          <div className=\"flex flex-col items-center p-6\">\n            <h2 className=\"mb-1 text-xl text-main\">{ctx.apply('i18n.t', 'AdvisorVideoReceiver.callInfo')}</h2>\n            {_.get(\n              IconStatus,\n              ctx.get('purchaseData.status'),\n              IconStatus.unknown\n            )({ name: ctx.apply('i18n.t', `Transaction.Status.${ctx.get('purchaseData.status')}`) })}\n            <div className=\"flex mt-2\">\n              <p className=\"mb-0 mr-2 text-4xl text-main\">{ctx.get('purchaseData.bill.totalAfter')}</p>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex justify-center py-6\">\n            <Avatar size={80} src={ctx.get('purchaseData.advisorProfile.avatarUrl')} />\n            <div className=\"ml-4\">\n              <h1 className=\"mb-0 text-xl font-medium\">{ctx.get('purchaseData.advisorProfile.displayName')}</h1>\n              <div className=\"flex items-center mb-1\">\n                <div className=\"mr-2 text-base\">{ctx.get('purchaseData.advisorProfile.rating.ratingText')}</div>\n                <Rate disabled count={5} value={ctx.get('purchaseData.advisorProfile.rating.ratingScore')} />\n              </div>\n              <div className=\"uppercase text-sub text-xxs\">\n                {ctx.get('purchaseData.advisorProfile.reviewCount')} {ctx.apply('i18n.t', 'Payment.Profile.reviews')}\n              </div>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n          <div className=\"flex flex-col p-6 bg-white200\">\n            <h2 className=\"text-xl\">{ctx.apply('i18n.t', 'Transaction.Detail.paymentDetail')}</h2>\n            <div className=\"flex justify-between\">\n              <span className=\"text-base text-sub\">\n                {ctx.apply('i18n.t', 'UserPayment.serviceType', { kind: ctx.get('purchaseData.service.kind') })}\n              </span>\n              <span className=\"text-base text-main\">{ctx.get('purchaseData.service.name')}</span>\n            </div>\n            <div className=\"my-6 border-b border-divider\"></div>\n            <div className=\"flex justify-between mb-3\">\n              <span className=\"text-base text-sub\">{ctx.apply('i18n.t', 'Payment.Bill.tempCost')}</span>\n              <span className=\"text-base text-main\">{ctx.get('purchaseData.bill.totalBefore')}</span>\n            </div>\n            {ctx.get('purchaseData.bill.discount') && (\n              <div className=\"flex justify-between\">\n                <span className=\"text-base text-sub\">{ctx.apply('i18n.t', 'Payment.Bill.promotion')}</span>\n                <span className=\"text-base text-main\">-{ctx.get('purchaseData.bill.discount')}</span>\n              </div>\n            )}\n            <div className=\"my-6 border-b border-divider\"></div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-base font-semibold text-main\">{ctx.apply('i18n.t', 'Payment.Bill.totalCost')}</span>\n              <span className=\"text-base text-branda\">{ctx.get('purchaseData.bill.totalAfter')}</span>\n            </div>\n          </div>\n          <div className=\"border-b border-divider\"></div>\n        </section>\n      </div> */}\n    </DIV>\n  );\n};\n\nexport default Index;\n","import React from 'react';\nimport { bindings, hook } from '@vl/redata';\nimport useRoute from '@vl/hooks/useGbRoute';\nimport _ from 'lodash';\nimport PurchaseModel from '@uz/unitz-models/PurchaseModel';\nimport TransactionModel from '@uz/unitz-models/TransactionModel';\nimport AdvisorProfileFormatter from '@uz/unitz-models/AdvisorProfileModel/formatter';\nimport useSubjectSource from '@vl/hooks/useSubjectSource';\n// import useSubjectState from '@vl/hooks/useSubjectState';\nimport AdvisorFormatter from '@uz/unitz-models/AdvisorModel/formatter';\nimport TransactionFormatter from '@uz/unitz-models/TransactionModel/formatter';\nimport CFAdvisorProfileFormatter from '@uz/unitz-models/CFAdvisorProfileModel/formatter';\nimport PurchaseFormatter from '@uz/unitz-models/PurchaseModel/formatter';\nimport usePromiseSource from '@vl/hooks/usePromiseSource';\nimport useObservableSource from '@vl/hooks/useObservableSource';\nimport { formatVND } from '@vl/mod-utils/currencyFormatter';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport AdvisorReviewModel from '@uz/unitz-models/AdvisorReviewModel';\n\nconst bindData = bindings({\n  pageContainer: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            transaction: hook((ctx) => {\n              const session_id = _.get(useRoute(), 'params.session_id', '');\n              const items = useObservableSource(() => TransactionModel.find(\n                `where: {session_id: {_eq: \"${session_id}\"}}`,\n                `\n                    service_pricing {\n                      detail {\n                        per_amount\n                        per_unit\n                        price_amount\n                        price_currency\n                        duration_amount: per_amount\n                        duration_unit: per_unit\n                      }\n                    }\n                    session_detail {\n                      duration_unit\n                      duration_amount\n                    }\n                    status_latest {\n                      status\n                    }\n                  `\n              ));\n              return items;\n            }),\n            transactionData: hook((ctx) => {\n              const transactions = useSubjectSource(ctx.get('transaction'));\n              const transaction = _.get(transactions, '0');\n              const statusLatest = TransactionFormatter.statusLatest(ctx)(transaction);\n              const callPackageTimeMinute = AdvisorFormatter.callPackageTimeMinute(ctx)(transaction);\n              return {\n                callPackage: AdvisorFormatter.callPackage(ctx)(transaction),\n                callPackageTime: AdvisorFormatter.callPackageTime(ctx)(transaction),\n                callPackagePrice: AdvisorFormatter.callPackagePrice(ctx)(transaction),\n                callPackageTotal: AdvisorFormatter.callPackageTotal(ctx)(transaction),\n                callPackageTimeMinute,\n                statusLatest,\n              };\n            }),\n            purchaseData: hook((ctx) => {\n              const purchase_id = _.get(useRoute(), 'params.purchase_id', '');\n              const purchaseData = usePromiseSource(\n                async () => {\n                  if (!purchase_id) return null;\n                  try {\n                    const purchase = await PurchaseModel.find(\n                      `where: {id: {_eq: \"${purchase_id}\"}}`,\n                      `\n                        id\n                        payments {\n                          amount\n                          type\n                        }\n                        services {\n                          id\n                          price_amount\n                          advisor_service {\n                            id\n                            service_id\n                            advisor {\n                              id\n                              profile {\n                                display_name\n                                avatar_url\n                              }\n                              review_agg {\n                                avg_score\n                              }\n                              reviews_aggregate {\n                                aggregate { count }\n                              }\n                            }\n                            service {\n                              name\n                              kind\n                              id\n                            }\n                            price {\n                              price_amount\n                              price_currency\n                              per_unit\n                              per_amount\n                            }\n                            discounts {\n                              percentage\n                              currency\n                              id\n                              amount\n                              type\n                            }  \n                          }\n                          \n                        }\n                        status {\n                          status\n                        }\n                        status_latest {\n                          status\n                        }\n                      `\n                    );\n                    return _.first(purchase.toObject());\n                  } catch (err) {}\n                },\n                null,\n                [purchase_id]\n              );\n\n              const advisorService = _.get(purchaseData, 'services.0.advisor_service');\n              const advisor = _.get(advisorService, 'advisor');\n              const service = _.get(advisorService, 'service');\n              const advisorProfile = _.get(advisor, 'profile');\n              const reviewAggregate = _.get(advisor, 'reviews_aggregate.aggregate');\n              const bill = CFAdvisorProfileFormatter.amountPayment(ctx)(advisorService);\n\n              const rtn = {\n                advisorProfile: {\n                  displayName: AdvisorProfileFormatter.displayName(ctx)(advisorProfile),\n                  avatarUrl: AdvisorProfileFormatter.avatarUrl(ctx)(advisorProfile),\n                  rating: {\n                    ratingText: AdvisorProfileFormatter.reviewText(ctx)(advisor),\n                    ratingScore: AdvisorProfileFormatter.reviewScore(ctx)(advisor),\n                  },\n                  reviewCount: AdvisorProfileFormatter.reviewCount(ctx)(reviewAggregate),\n                },\n                status: PurchaseFormatter.getStatus(ctx)(purchaseData),\n                bill: {\n                  totalAfter: _.get(bill, 'totalAfter') ? formatVND(_.get(bill, 'totalAfter')) : 0,\n                  totalBefore: _.get(bill, 'totalBefore') ? formatVND(_.get(bill, 'totalBefore')) : 0,\n                  discount: _.get(bill, 'discount') ? formatVND(_.get(bill, 'discount')) : 0,\n                },\n                service,\n              };\n              return rtn;\n            }),\n            form: hook((ctx) => {\n              const advisor_id = _.get(useRoute(), 'params.id', '');\n              const user_id = ctx.apply('authModel.getUserId');\n              // const userId = ctx.apply('authModel.getUserId');\n              const form = useFormik({\n                initialValues: {\n                  rating: 5,\n                  note: '',\n                },\n                onSubmit: async (values) => {\n                  try {\n                    await AdvisorReviewModel.create({\n                      target_id: advisor_id,\n                      review_text: _.get(values, 'note', ''),\n                      score: _.get(values, 'rating', 0) * 2,\n                      created_by: user_id,\n                    });\n                    await ctx.apply('stepModel.handlers.callFinish');\n                  } catch (error) {\n                    console.log(error);\n                  }\n                },\n                validationSchema: Yup.object().shape({\n                  rating: Yup.number().required(ctx.apply('i18n.t', 'Form.required')),\n                }),\n              });\n              return form;\n            }),\n            canSubmit: hook((ctx) => {\n              return ctx.get('form.isValid') && !ctx.get('form.isSubmitting');\n            }),\n            page: hook((ctx) => {\n              const [rating, $rating] = React.useState(false);\n              React.useEffect(() => {\n                if (ctx.get('transactionData.callPackageTimeMinute') >= 3 && !rating) {\n                  $rating(true);\n                }\n              }, [ctx.get('transactionData.callPackageTimeMinute')]);\n              return {\n                rating,\n                $rating,\n                handlers: {\n                  ratingFinish: () => {\n                    $rating(false);\n                  },\n                },\n              };\n            }),\n          },\n        },\n      ],\n    ],\n  },\n  isLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n  notLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n  completedSuccess: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => {\n            const completeStatus = _.get(useRoute(), 'params.status');\n            return (\n              ctx.get('transactionData.statusLatest') !== 'incomplete'\n              && (!completeStatus || completeStatus === 'completed')\n              && !ctx.get('page.rating')\n            );\n          }),\n        },\n      ],\n    ],\n  },\n  completedMissed: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => _.get(useRoute(), 'params.status') === 'missed'),\n        },\n      ],\n    ],\n  },\n  completedRejected: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => _.get(useRoute(), 'params.status') === 'rejected'),\n        },\n      ],\n    ],\n  },\n  completedEarlyEnd: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => _.get(useRoute(), 'params.status') === 'completed'\n              && ctx.get('transactionData.statusLatest') === 'incomplete'\n          ),\n        },\n      ],\n    ],\n  },\n  completedRating: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.get('page.rating')),\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallConnecting\">\n      <section className=\"fixed absolute top-0 left-0 flex items-center justify-center w-full min-h-full py-0 bg-main\">\n        <article className=\"absolute top-6 left-6 max-sm:hidden\">\n          <h1 className=\"mb-1 text-xl font-medium text-white\">{ctx.get('@items.advisorProfile.displayName')}</h1>\n          <span className=\"text-base text-white animate-pulse\">\n            {ctx.apply('i18n.t', 'AdvisorVideoCall.ringingStatusTxt')}\n          </span>\n        </article>\n        <div className=\"flex flex-col items-center\">\n          <div className=\"absolute flex items-center justify-center rounded-full w-44 h-44 bg-white200 bg-opacity-40 animate-ping\">\n            <div className=\"flex items-center justify-center bg-opacity-50 rounded-full w-36 h-36 bg-white300\">\n              <div className=\"flex items-center justify-center rounded-full bg-opacity-70 w-28 h-28 bg-white400\"></div>\n            </div>\n          </div>\n          <Avatar className=\"opacity-100\" src={ctx.get('@items.advisorProfile.avatarUrl')} size={168} />\n          <article className=\"flex flex-col items-center mt-10 max-w-xxs min-sm:hidden\">\n            <h1 className=\"mb-1 text-xl font-medium text-white\">{ctx.get('@items.advisorProfile.displayName')}</h1>\n            <span className=\"text-base text-center text-white animate-pulse\">\n              {ctx.apply('i18n.t', 'AdvisorVideoCall.ringingStatusTxt')}\n            </span>\n          </article>\n        </div>\n      </section>\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport { Avatar } from '@uz/unitz-components-web/Avatar';\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallIniting\">\n      <section className=\"fixed absolute top-0 left-0 flex items-center justify-center w-full min-h-full py-0 bg-main\">\n        <article className=\"absolute top-6 left-6 max-sm:hidden\">\n          <h1 className=\"mb-1 text-xl font-medium text-white\">{ctx.get('@items.advisorProfile.displayName')}</h1>\n          <span className=\"text-base text-white animate-pulse\">\n            {ctx.apply('i18n.t', 'AdvisorVoiceCall.initingStatusTxt')}\n          </span>\n        </article>\n        <div className=\"flex flex-col items-center\">\n          <div className=\"absolute flex items-center justify-center rounded-full w-44 h-44 bg-white200 bg-opacity-40 animate-ping\">\n            <div className=\"flex items-center justify-center bg-opacity-50 rounded-full w-36 h-36 bg-white300\">\n              <div className=\"flex items-center justify-center rounded-full bg-opacity-70 w-28 h-28 bg-white400\"></div>\n            </div>\n          </div>\n          <Avatar className=\"opacity-100\" src={ctx.get('@items.advisorProfile.avatarUrl')} size={168} />\n          <article className=\"flex flex-col items-center mt-10 min-sm:hidden\">\n            <h1 className=\"mb-1 text-xl font-medium text-white\">{ctx.get('@items.advisorProfile.displayName')}</h1>\n            <span className=\"text-base text-center text-white animate-pulse\">\n              {ctx.apply('i18n.t', 'AdvisorVoiceCall.initingStatusTxt')}\n            </span>\n          </article>\n        </div>\n      </section>\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport gstyles from '@vl/gstyles';\nimport RefreshInterval from '@uz/unitz-components-web/RefreshInterval';\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallOnProgress\">\n      <section className=\"fixed flex items-center justify-center py-0 bg-transparent top-6 left-6\">\n        <article>\n          <h1 className=\"flex flex-row mb-1 text-xl font-medium text-white\">\n            {ctx.get('@items.advisorProfile.displayName')}{' '}\n            {gstyles.icons({\n              name: ctx.apply('videoCallModel.useState', 'otherState.micMute') ? 'micro-off' : 'micro',\n              fill: gstyles.colors.white500,\n              size: 12,\n            })}\n          </h1>\n\n          <RefreshInterval interval={1000}>\n            {() => (\n              <span className=\"text-base text-white animate-pulse\">\n                {ctx.apply('i18n.t', 'AdvisorInCome.inComeTextPackage', {\n                  num: ctx.apply('videoCallModel.getCallMaxDuration'),\n                })}{' '}\n                / {ctx.apply('videoCallModel.getCallDuration')}\n              </span>\n            )}\n          </RefreshInterval>\n        </article>\n      </section>\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport Draggable from 'react-draggable'; // Both at the same time\nimport cx from 'classnames';\nimport styled from 'styled-components';\nimport _ from 'lodash';\nimport { ResponsiveProps } from '@uz/unitz-components-web/Responsive';\n\nconst DraggableHandle = styled.div`\n  &.fixed-position {\n    transform: none !important;\n    cursor: default !important;\n  }\n`;\n\nconst PublisherHandler = ({ children, className, ...props }) => {\n  return (\n    <DIV>\n      <ResponsiveProps\n        sm={{\n          normal: {\n            top: 12,\n            right: 12,\n            width: 120,\n            height: 150,\n          },\n          collapse: {\n            top: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0) / 2,\n            right: 0,\n            width: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0),\n            height: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0) / 2,\n          },\n        }}\n        md={{\n          normal: {\n            top: 46,\n            right: 46,\n            width: 190,\n            height: 106,\n          },\n          collapse: {\n            top: 0,\n            right: 0,\n            width: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0) / 2,\n            height: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0),\n          },\n        }}\n        lg={{\n          normal: {\n            top: 46,\n            right: 46,\n            width: 190,\n            height: 106,\n          },\n          collapse: {\n            top: 0,\n            right: 0,\n            width: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0) / 2,\n            height: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0),\n          },\n        }}\n      >\n        {(resProps) => {\n          const width = _.get(resProps, 'width', 190);\n          const height = _.get(resProps, 'height', 106);\n          const top = _.get(resProps, 'top', 46);\n          const right = _.get(resProps, 'right', 46);\n          return (\n            <div\n              onClick={(e) => {\n                e.stopPropagation();\n                ctx.apply('smartGesture.$touchSmallScreen');\n              }}\n              style={{\n                position: 'absolute',\n                top,\n                right,\n                zIndex: 10,\n                width,\n                height,\n                ..._.get(resProps, 'normal', {}),\n                ...(ctx.apply('videoCallModel.useState', 'myState.videoMute')\n                  ? {\n                    height: 0,\n                  }\n                  : {}),\n                ...(!ctx.apply('videoCallModel.useState', 'myState.collapse')\n                  ? {\n                    top: 0,\n                    right: 0,\n                    bottom: 0,\n                    width: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0) / 2,\n                    height: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0),\n                    ..._.get(resProps, 'collapse', {}),\n                  }\n                  : {}),\n              }}\n            >\n              <Draggable\n                axis=\"both\"\n                handle=\".drag-handle\"\n                defaultPosition={{ x: 0, y: 0 }}\n                position={null}\n                grid={[8, 8]}\n                scale={1}\n                onDrag={ctx.get('smartGesture.onDrag')}\n                onStop={ctx.get('smartGesture.onStopDrag')}\n                bounds={{\n                  top: -top,\n                  right,\n                  bottom: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0) - top - height,\n                  left:\n                    0 - (_.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0) - right - width),\n                }}\n                disabled={!ctx.apply('videoCallModel.useState', 'myState.collapse')}\n              >\n                <DraggableHandle\n                  className={cx(className, 'w-full h-full drag-handle bg-transparent', {\n                    'cursor-move': ctx.apply('videoCallModel.useState', 'myState.collapse'),\n                    'fixed-position': !ctx.apply('videoCallModel.useState', 'myState.collapse'),\n                  })}\n                  {...props}\n                >\n                  {children}\n                </DraggableHandle>\n              </Draggable>\n            </div>\n          );\n        }}\n      </ResponsiveProps>\n    </DIV>\n  );\n};\n\nexport default PublisherHandler;\n","import React from 'react';\nimport _ from 'lodash';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport Loadable from '@loadable/component';\n\nimport PublisherHandler from './PublisherHandler';\n\nimport { ResponsiveProps } from '@uz/unitz-components-web/Responsive';\n\nconst OTSession = Loadable(() => import('./OpenTok/OTSession'));\nconst OTPublisher = Loadable(() => import('./OpenTok/OTPublisher'));\nconst OTStreams = Loadable(() => import('./OpenTok/OTStreams'));\nconst OTSubscriber = Loadable(() => import('./OpenTok/OTSubscriber'));\n\nfunction areEqual(prevProps, nextProps) {\n  return _.isEqual(prevProps.layout, nextProps.layout);\n}\n\nconst CallSession = React.memo(({ videoCallModel, layout }) => {\n  const isSSR = typeof window === 'undefined';\n  if (isSSR) return null;\n  return (\n    <DIV forceCtx>\n      <div onClick={ctx.get('smartGesture.$touchScreen')}>\n        <OTSession {...ctx.get('tokbox')}>\n          {ctx.get('smartGesture.swap') ? (\n            <OTStreams className=\"w-full h-full\">\n              <PublisherHandler>\n                <OTSubscriber\n                  className=\"w-full h-full bg-transparent\"\n                  {...ctx.get('tokboxSubscriber')}\n                  properties={{\n                    showControls: false,\n                    height: '100%',\n                    width: '100%',\n                  }}\n                />\n              </PublisherHandler>\n            </OTStreams>\n          ) : (\n            <PublisherHandler>\n              <OTPublisher\n                className=\"w-full h-full bg-transparent\"\n                properties={{\n                  cameraPosition: videoCallModel.useState('cameraPosition'),\n                  publishAudio: !videoCallModel.useState('myState.micMute'),\n                  publishVideo: !videoCallModel.useState('myState.videoMute'),\n                  width: '100%',\n                  height: '100%',\n                  showControls: false,\n                }}\n                eventHandlers={{\n                  error: (...args) => {\n                    console.log('error', args);\n                  },\n                  otrnError: (...args) => {\n                    console.log('otrnError', args);\n                  },\n                }}\n              />\n            </PublisherHandler>\n          )}\n\n          <div\n            style={{\n              ..._.pick(layout, ['width', 'height']),\n            }}\n          >\n            {ctx.get('smartGesture.swap') ? (\n              <ResponsiveProps\n                sm={{ width: layout.width, height: layout.height / 2 }}\n                md={{ width: layout.width / 2, height: layout.height }}\n                lg={{ width: layout.width / 2, height: layout.height }}\n              >\n                {(resProps) => (\n                  <div\n                    className=\"absolute bg-transparent\"\n                    style={{\n                      ..._.pick(layout, ['width', 'height']),\n                      ...(!ctx.apply('videoCallModel.useState', 'myState.collapse')\n                        ? {\n                          left: 0,\n                          top: 0,\n                          width: layout.width / 2,\n                          height: layout.height,\n                          ...resProps,\n                        }\n                        : {}),\n                    }}\n                  >\n                    <OTPublisher\n                      className=\"w-full h-full bg-transparent\"\n                      properties={{\n                        cameraPosition: videoCallModel.useState('cameraPosition'),\n                        publishAudio: !videoCallModel.useState('myState.micMute'),\n                        publishVideo: !videoCallModel.useState('myState.videoMute'),\n                        width: '100%',\n                        height: '100%',\n                        showControls: false,\n                      }}\n                      eventHandlers={{\n                        error: (...args) => {\n                          console.log('error', args);\n                        },\n                        otrnError: (...args) => {\n                          console.log('otrnError', args);\n                        },\n                      }}\n                    />\n                  </div>\n                )}\n              </ResponsiveProps>\n            ) : (\n              <OTStreams>\n                <ResponsiveProps\n                  sm={{ width: layout.width, height: layout.height / 2 }}\n                  md={{ width: layout.width / 2, height: layout.height }}\n                  lg={{ width: layout.width / 2, height: layout.height }}\n                >\n                  {(resProps) => (\n                    <div\n                      className=\"absolute bg-transparent\"\n                      style={{\n                        ..._.pick(layout, ['width', 'height']),\n                        ...(!ctx.apply('videoCallModel.useState', 'myState.collapse')\n                          ? {\n                            left: 0,\n                            top: 0,\n                            width: layout.width / 2,\n                            height: layout.height,\n                            ...resProps,\n                          }\n                          : {}),\n                      }}\n                    >\n                      <OTSubscriber\n                        className=\"w-full h-full bg-transparent\"\n                        {...ctx.get('tokboxSubscriber')}\n                        properties={{\n                          showControls: false,\n                          height: '100%',\n                          width: '100%',\n                        }}\n                      />\n                    </div>\n                  )}\n                </ResponsiveProps>\n              </OTStreams>\n            )}\n          </div>\n        </OTSession>\n      </div>\n    </DIV>\n  );\n}, areEqual);\n\nconst View8 = () => {\n  return (\n    <DIV className=\"callSession\">\n      {ctx.apply('LAYOUT.useLayout', { layout: 'AdvisorVideoCallStatus' }, ({ layout }) => {\n        if (!layout) return null;\n        if (!ctx.get('tokbox.sessionId')) return null;\n        const videoCallModel = ctx.get('videoCallModel');\n        return <CallSession videoCallModel={videoCallModel} layout={layout} />;\n      })}\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\nimport gstyles from '@vl/gstyles';\nimport cx from 'classnames';\n\nimport { Dropdown } from 'antd';\n\nconst MenuSetting = ({ data }) => {\n  return (\n    <div className=\"flex flex-col w-48 py-2 rounded-lg mb-20px bg-white500\">\n      {data\n        && data.map(({ icon = '', name = '', ...rest }, index) => (\n          // eslint-disable-next-line\n          <div key={`${index}`} className=\"flex px-3 py-2 cursor-pointer\" {...rest}>\n            {icon}\n            <span className=\"text-main\">{name}</span>\n          </div>\n        ))}\n    </div>\n  );\n};\n\nconst ControlButton = ({\n  className, icon, text, horizontal, disable, onClick, ...rest\n}) => {\n  return (\n    <div\n      {...rest}\n      onClick={disable ? null : onClick}\n      className={cx(\n        `flex items-center justify-center cursor-pointer text-white500 ${className}`,\n        { 'flex-col': !horizontal },\n        { 'opacity-50': disable }\n      )}\n    >\n      {icon}\n      {!!text && <div className=\"mb-0 font-light text-normal\">{text}</div>}\n    </div>\n  );\n};\n\nconst View8 = () => {\n  return (\n    <DIV className=\"videoCallConnecting\">\n      <section\n        className={cx(\n          'absolute bottom-0 z-10 flex justify-between w-full min-lg:px-6 max-lg:px-4 py-4 transition-transform duration-100 ease-in-out transform max-lg:flex-col bg-black400 bg-opacity-70',\n          { '': ctx.get('smartGesture.controlBarStatus') === 'full' },\n          { 'max-lg:translate-y-full': ctx.get('smartGesture.controlBarStatus') === 'hide' },\n          { 'max-lg:translate-y-16': ctx.get('smartGesture.controlBarStatus') === 'half' }\n        )}\n      >\n        <div className=\"relative flex justify-between max-lg:hidden w-36\">\n          <Dropdown\n            visible={ctx.get('@sectionActions.visibleDropdown')}\n            overlay={\n              <MenuSetting\n                data={[\n                  {\n                    onClick: () => {\n                      ctx.apply('videoCallModel.setState', 'myState.collapse', false);\n                      ctx.apply('@sectionActions.$visibleDropdown', !ctx.get('@sectionActions.visibleDropdown'));\n                    },\n                    icon: gstyles.icons({\n                      name: 'split-screen',\n                      size: 22,\n                      fill: gstyles.colors.sub,\n                      className: 'mr-3',\n                    }),\n                    name: ctx.apply('i18n.t', 'VideoCallPage.SectionAction.split'),\n                  },\n                  {\n                    onClick: () => {\n                      ctx.apply('videoCallModel.setState', 'myState.collapse', true);\n                      ctx.apply('@sectionActions.$visibleDropdown', !ctx.get('@sectionActions.visibleDropdown'));\n                    },\n                    icon: gstyles.icons({\n                      name: 'pic-in-pic',\n                      size: 22,\n                      fill: gstyles.colors.sub,\n                      className: 'mr-3',\n                    }),\n                    name: ctx.apply('i18n.t', 'VideoCallPage.SectionAction.collapse'),\n                  },\n                ]}\n              />\n            }\n            placement=\"topLeft\"\n            trigger={['click']}\n          >\n            <ControlButton\n              disable={ctx.apply('videoCallModel.getCallState') !== 'videoCallOnProgress'}\n              className={cx({ 'opacity-10': !ctx.get('tokbox.sessionId') })}\n              onClick={() => {\n                ctx.apply('@sectionActions.$visibleDropdown', !ctx.get('@sectionActions.visibleDropdown'));\n              }}\n              icon={gstyles.icons({\n                name: 'setting',\n                fill: gstyles.colors.white500,\n                size: 24,\n                className: 'mb-2',\n              })}\n              text={ctx.apply('i18n.t', 'VideoCallPage.SectionAction.setting')}\n            />\n          </Dropdown>\n        </div>\n\n        <div className=\"flex justify-between p-0 min-lg:w-52 max-lg:w-full\">\n          <div className=\"flex flex-col items-center flex-1\">\n            <ControlButton\n              className={cx(\n                'w-12 h-12 rounded-full',\n                { 'bg-white500': ctx.apply('videoCallModel.useState', 'myState.micMute') },\n                { 'bg-white200 bg-opacity-30': !ctx.apply('videoCallModel.useState', 'myState.micMute') }\n              )}\n              onClick={() => {\n                ctx.apply('videoCallModel.toggleMic');\n              }}\n              icon={gstyles.icons({\n                name: ctx.apply('videoCallModel.useState', 'myState.micMute') ? 'micro-off' : 'micro',\n                fill: ctx.apply('videoCallModel.useState', 'myState.micMute')\n                  ? gstyles.colors.main\n                  : gstyles.colors.white500,\n                size: 24,\n              })}\n            />\n\n            <span className=\"mt-2 text-white min-lg:hidden\">\n              {ctx.apply(\n                'i18n.t',\n                `AdvisorVideoReceiver.${\n                  !ctx.apply('videoCallModel.useState', 'myState.micMute') ? 'microOff' : 'microOn'\n                }`\n              )}\n            </span>\n          </div>\n          <div className=\"flex flex-col items-center flex-1\">\n            <ControlButton\n              onClick={() => {\n                ctx.apply('videoCallModel.toggleVideo');\n              }}\n              className={cx(\n                'w-12 h-12 rounded-full',\n                { 'bg-white500': ctx.apply('videoCallModel.useState', 'myState.videoMute') },\n                { 'bg-white200 bg-opacity-30': !ctx.apply('videoCallModel.useState', 'myState.videoMute') }\n              )}\n              icon={gstyles.icons({\n                name: ctx.apply('videoCallModel.useState', 'myState.videoMute') ? 'videocam-off' : 'videocam',\n                fill: ctx.apply('videoCallModel.useState', 'myState.videoMute')\n                  ? gstyles.colors.main\n                  : gstyles.colors.white500,\n                size: 24,\n              })}\n            />\n            <span className=\"mt-2 text-white min-lg:hidden\">\n              {ctx.apply(\n                'i18n.t',\n                `AdvisorVideoReceiver.${\n                  ctx.apply('videoCallModel.useState', 'myState.videoMute') ? 'videoOn' : 'videoOff'\n                }`\n              )}\n            </span>\n          </div>\n          <div className=\"flex flex-col items-center flex-1\">\n            <ControlButton\n              onClick={() => {\n                ctx.apply('videoCallModel.endCall');\n              }}\n              className=\"w-12 h-12 rounded-full bg-red \"\n              icon={gstyles.icons({ name: 'call-end', fill: gstyles.colors.white500, size: 24 })}\n            />\n            <span className=\"mt-2 text-white min-lg:hidden\">{ctx.apply('i18n.t', 'AdvisorVideoReceiver.endCall')}</span>\n          </div>\n        </div>\n        <div className=\"flex justify-between w-36 max-lg:hidden\">\n          {/* <ControlButton\n            icon={gstyles.icons({\n              name: 'add-note',\n              fill: gstyles.colors.white500,\n              size: 24,\n              className: 'mb-2',\n            })}\n            text={ctx.apply('i18n.t', 'VideoCallPage.SectionAction.note')}\n          />\n          <ControlButton\n            icon={gstyles.icons({\n              name: 'heart',\n              fill: gstyles.colors.white500,\n              size: 24,\n              className: 'mb-2',\n            })}\n            text={ctx.apply('i18n.t', 'VideoCallPage.SectionAction.like')}\n          /> */}\n        </div>\n        <div className=\"flex justify-between pt-6 min-lg:hidden\">\n          <ControlButton\n            className={cx(\n              'px-4 py-2 rounded-3xl flex-row',\n              { 'bg-white500 text-main': !ctx.apply('videoCallModel.useState', 'myState.collapse') },\n              { 'bg-white200 bg-opacity-30': ctx.apply('videoCallModel.useState', 'myState.collapse') }\n            )}\n            onClick={() => {\n              ctx.apply('videoCallModel.setState', 'myState.collapse', false);\n            }}\n            icon={gstyles.icons({\n              name: 'split-screen',\n              size: 24,\n              fill: ctx.apply('videoCallModel.useState', 'myState.collapse')\n                ? gstyles.colors.white500\n                : gstyles.colors.sub,\n              className: 'mr-2',\n            })}\n            horizontal\n            text={ctx.apply('i18n.t', 'VideoCallPage.SectionAction.split')}\n          />\n          <ControlButton\n            className={cx(\n              'px-4 py-2 rounded-3xl flex-row',\n              { 'bg-white500 text-main': ctx.apply('videoCallModel.useState', 'myState.collapse') },\n              { 'bg-white200 bg-opacity-30': !ctx.apply('videoCallModel.useState', 'myState.collapse') }\n            )}\n            onClick={() => {\n              ctx.apply('videoCallModel.setState', 'myState.collapse', true);\n            }}\n            icon={gstyles.icons({\n              name: 'pic-in-pic',\n              size: 22,\n              fill: ctx.apply('videoCallModel.useState', 'myState.collapse')\n                ? gstyles.colors.sub\n                : gstyles.colors.white500,\n              className: 'mr-2',\n            })}\n            horizontal\n            text={ctx.apply('i18n.t', 'VideoCallPage.SectionAction.collapse')}\n          />\n        </div>\n      </section>\n    </DIV>\n  );\n};\n\nexport default View8;\n","import React from 'react';\nimport DIV from '@vl/redata/DIV.macro';\nimport _ from 'lodash';\nimport { ctx } from '@vl/redata';\nimport {\n  VideoCallConnecting, VideoCallIniting, VideoCallOnProgress, VideoCallSession\n} from './components';\n\nconst Index = () => {\n  return (\n    <DIV className=\"videoComponent\">\n      <div\n        className=\"drag-bounds\"\n        style={{\n          position: 'fixed',\n          zIndex: -100,\n          top: 0,\n          left: 0,\n          width: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'width', 0),\n          height: _.get(ctx.apply('LAYOUT.getLayout', 'AdvisorVideoCallStatus'), 'height', 0),\n          background: 'transparent',\n        }}\n      />\n      <VideoCallSession />\n      <VideoCallIniting />\n      <VideoCallConnecting />\n      <VideoCallOnProgress />\n    </DIV>\n  );\n};\n\nexport default Index;\n","export const INTERNET_STATES = {\n  connected: 'connected',\n  reconnecting: 'reconnecting',\n  disconnect: 'disconnect'\n};\n","import connectFirestore from '@vl/mod-utils/connectFirestore';\nimport { INTERNET_STATES } from './constants';\n\nclass VideoCallState {\n  // syncable state here\n\n  // local state here\n  _local = {\n    ctx: null\n  };\n\n  constructor(data, ctx) {\n    const {\n      id, user_id, advisor_id, ...rest\n    } = data;\n    // init state\n    Object.assign(this, {\n      states: {\n        videoCallConnecting: false\n      },\n      sessionData: {},\n      user_id,\n      advisor_id,\n      session_id: id,\n      peerStates: {\n        [user_id]: {\n          micMute: false,\n          videoMute: false,\n          cameraPosition: '',\n          collapse: true,\n          internetStatus: INTERNET_STATES.connected\n        },\n        [advisor_id]: {\n          micMute: false,\n          videoMute: false,\n          cameraPosition: '',\n          collapse: true,\n          internetStatus: INTERNET_STATES.connected\n        }\n      },\n      ...rest\n    });\n\n    this._local.ctx = ctx;\n  }\n\n  get myState() {\n    return this.peerStates[this.uid];\n  }\n\n  get otherState() {\n    return this.peerStates[this.oid];\n  }\n\n  get peerState() {\n    return this.peerStates[this.uid];\n  }\n\n  get uid() {\n    const uid = this._local.ctx.apply('authModel.getUserId');\n    return uid;\n  }\n\n  get oid() {\n    const userId = this.user_id;\n    const advisorId = this.advisor_id;\n    const { uid } = this;\n    return uid === userId ? advisorId : userId;\n  }\n\n  onConnect(state) {\n    // connect to sync with firestore data;\n    state.once(\n      'onDestroy',\n      connectFirestore(this._local.ctx, this)(state, {\n        docId: this.session_id,\n        collectionName: 'videocalls'\n      })\n    );\n  }\n}\n\nexport default VideoCallState;\n","import _ from 'lodash';\n\nimport fbFnsClient from '@vl/mod-clients/fibGatsbyFns';\nimport fibApp from '@vl/mod-clients/fibGatsby';\n\nimport { BaseModel } from '@uz/unitz-models/BaseModel';\n\nimport Stream from '@vl/mod-utils/Stream';\nimport moment from 'moment';\nimport { durationFormatter } from '@vl/mod-utils/currencyFormatter';\n\nimport VideoCallState from './VideoCallState';\nimport { INTERNET_STATES } from './constants';\n\nconst NOTIF_INTERVAL = 2000;\n\nconst EventType = {};\n\nclass InstanceMap {\n  items = {};\n\n  add(instance) {\n    const id = instance.get('id');\n    if (!id) return null;\n    this.items[id] = instance;\n  }\n\n  get(id) {\n    return this.items[id];\n  }\n}\n\n// export class VideoCallModel extends BaseModel {\nexport class VideoCallModel extends BaseModel {\n  static instances = new InstanceMap();\n\n  static CALL_STATES = {\n    videoCallConnecting: 'videoCallConnecting',\n    videoCallOnProgress: 'videoCallOnProgress',\n    videoCallIncomming: 'videoCallIncomming',\n    videoCallFinish: 'videoCallFinish',\n    videoCallIniting: 'videoCallIniting',\n    videoCallTaking: 'videoCallTaking',\n    videoCallReject: 'videoCallReject',\n  };\n\n  static INTERNET_STATES = {\n    ...INTERNET_STATES,\n  };\n\n  state = {\n    callState: VideoCallModel.CALL_STATES.videoCallIniting,\n    videoMute: false,\n    cameraPosition: 'front',\n    startTime: null,\n    msg: '',\n    remoteState: {\n      videoMute: false,\n    },\n    localState: {\n      videoMute: false,\n    },\n  };\n\n  constructor(...args) {\n    super(...args);\n    this.constructor.initState(this);\n\n    const stream = new Stream();\n\n    this.set({\n      stream,\n      resolvers: {\n        user: async () => {\n          const user_id = this.get('user_id');\n          console.log('user_id', user_id);\n          // const user = await UserModel.fromId({ id: user_id });\n          // return user;\n          return { id: user_id };\n        },\n        advisor: async () => {\n          const advisor_id = this.get('advisor_id');\n          console.log('advisor_id', advisor_id);\n          // const instance = await AdvisorModel.fromId({ id: advisor_id });\n          // return instance;\n          // TODO: APP NÊN SỬA CHỔ NÀY.\n          return { id: advisor_id };\n        },\n      },\n    });\n\n    // configure stream reducer\n    stream.on('notify', async (msg) => {\n      // reschedule notify stream\n      const notifTimer = setTimeout(() => {\n        stream.emit('notify', msg);\n      }, NOTIF_INTERVAL);\n      this.set({ notifTimer });\n    });\n\n    stream.on('stopNotify', async () => {\n      // remove timer\n      const notifTimer = this.get('notifTimer');\n      if (notifTimer) {\n        clearTimeout(notifTimer);\n        this.set({ notifTimer: null });\n      }\n      // await notifee.cancelNotification(notifId);\n    });\n\n    // effect to start call\n    this.useEffect(\n      () => {\n        if (this.hasCallState(VideoCallModel.CALL_STATES.videoCallTaking)) {\n          this.startCall();\n          this.startTimer();\n        }\n      },\n      () => [this.getCallState()]\n    );\n    this.useEffect(\n      () => {\n        if (this.getState('states.startTime') && this.hasCallState(VideoCallModel.CALL_STATES.videoCallConnecting)) {\n          this.startCall();\n          this.startTimer();\n        }\n      },\n      () => [this.getState('states.startTime')]\n    );\n    // effect to end call\n    this.useEffect(\n      () => {\n        if (\n          this.getState('states.endTime')\n          && this.getState('states.videoCallComplete')\n          && !this.hasCallState(VideoCallModel.CALL_STATES.videoCallFinish)\n        ) {\n          this.setState({\n            endTime: moment(),\n            callState: VideoCallModel.CALL_STATES.videoCallFinish,\n          });\n        }\n      },\n      () => [this.getState('states.endTime'), this.getState('states.videoCallComplete')]\n    );\n\n    this.state.once('onDestroy', () => {\n      this.isMounted = false;\n      this.stopNotifySession();\n\n      if (\n        this.hasCallState(VideoCallModel.CALL_STATES.videoCallConnecting)\n        || this.hasCallState(VideoCallModel.CALL_STATES.videoCallIncomming)\n        || this.hasCallState(VideoCallModel.CALL_STATES.videoCallIniting)\n      ) {\n        this.setState('states.videoCallReject', true);\n      }\n    });\n  }\n\n  static create(data, opts) {\n    const instance = new VideoCallModel();\n    const id = _.get(data, 'data.session_id');\n\n    instance.set({ ...opts, msg: data, id });\n\n    this.instances.add(instance);\n    //\n    return instance;\n  }\n\n  static fromMessage(msg, ctx) {\n    const id = _.get(msg, 'data.session_id') || _.get(msg, 'id');\n    let instance = this.instances.get(id);\n    if (!instance) {\n      instance = this.create(msg);\n    }\n\n    const user_id = _.get(msg, 'data.user_id');\n\n    const advisor_id = _.get(msg, 'data.advisor_id');\n\n    const service_id = _.get(msg, 'data.service_id');\n\n    const session_id = _.get(msg, 'data.session_id');\n\n    if (user_id && advisor_id && service_id && session_id) {\n      instance.set({\n        user_id,\n        advisor_id,\n        service_id,\n        session_id,\n      });\n      instance.connectStore(ctx);\n    }\n\n    instance.ctx = ctx;\n\n    return instance;\n  }\n\n  static async fromSession({ user_id, advisor_id }) {\n    try {\n      const instance = await VideoCallModel.create({ user_id, advisor_id });\n      await instance.createSession();\n      return instance;\n    } catch (err) {\n      console.log('ererer', err);\n    }\n  }\n\n  static fromCall(callData) {\n    try {\n      const instance = VideoCallModel.create();\n      instance.set(callData);\n      return instance;\n    } catch (err) {\n      console.log('ererer', err);\n    }\n  }\n\n  connectStore(ctx) {\n    // store\n    const id = this.get('session_id');\n\n    const user_id = this.get('user_id');\n    const advisor_id = this.get('advisor_id');\n    const service_id = this.get('service_id');\n\n    this.state.enhance(\n      new VideoCallState(\n        {\n          id,\n          user_id,\n          advisor_id,\n          service_id,\n        },\n        ctx\n      )\n    );\n\n    console.log('connectStore', ctx);\n  }\n\n  getSectionId() {\n    const msg = this.get('msg');\n    const id = _.get(msg, 'data.session_id');\n    return id;\n  }\n\n  getSectionToken() {\n    const msg = this.get('msg');\n    const token = _.get(msg, 'data.session_token');\n    return token;\n  }\n\n  getSectionKey() {\n    const msg = this.get('msg');\n    const key = _.get(msg, 'data.session_key');\n    return key;\n  }\n\n  async createSession(ctx) {\n    // return null;\n\n    this.setState({\n      msg: 'AdvisorVideoCall.initingStatusTxt',\n    });\n\n    try {\n      const user_id = this.get('user_id');\n      const advisor_id = this.get('advisor_id');\n      const service_id = this.get('service_id');\n      const purchase_id = this.get('purchase_id');\n\n      const params = {\n        user_id,\n        advisor_id,\n        service_id,\n        purchase_id,\n      };\n\n      const data = await fbFnsClient.getClient().post('tasks-createSession', params);\n      // const data = {\n      //   user_id: '9KGhxtVGdPMD4VRIuZw25Iwo8x33',\n      //   advisor_id: 'PdOJWFBgNPUEMhX1JlsDm7zWy012',\n      //   service_id: '41734ba1-9129-49eb-9248-6ecbf3efe2d1',\n      //   session_id: '2_MX40NTc4ODY5Mn5-MTYyNjQyMDQ2ODc3Nn5LVHVMb1RZMjc3SWxtTXdRT3FHZnBuTVN-fg',\n      //   session_token:\n      //     'T1==cGFydG5lcl9pZD00NTc4ODY5MiZzaWc9ZWFhNTRlN2Q4Zjg0Nzg5YWY4NmM4MmIxNzc5YzE0M2E0YWQwM2M4MDpzZXNzaW9uX2lkPTJfTVg0ME5UYzRPRFk1TW41LU1UWXlOalF5TURRMk9EYzNObjVMVkhWTWIxUlpNamMzU1d4dFRYZFJUM0ZIWm5CdVRWTi1mZyZjcmVhdGVfdGltZT0xNjI2NDIwNDY5Jm5vbmNlPTAuMDUyNjEzNjUyMDExOTkzNTMmcm9sZT1wdWJsaXNoZXImZXhwaXJlX3RpbWU9MTYyNjUwNjg2OSZjb25uZWN0aW9uX2RhdGE9dXNlcl9pZCUzRDlLR2h4dFZHZFBNRDRWUkl1WncyNUl3bzh4MzMlMjZzZXJ2aWNlX2lkJTNENDE3MzRiYTEtOTEyOS00OWViLTkyNDgtNmVjYmYzZWZlMmQxJmluaXRpYWxfbGF5b3V0X2NsYXNzX2xpc3Q9',\n      //   session_key: '45788692',\n      //   session_duration: '1800',\n      //   kind: 'video',\n      // };\n\n      console.log({ data, params });\n\n      if (_.get(data, 'message.length', 0) > 0) {\n        return this.setState({\n          msg: { text: _.get(data, 'message') },\n        });\n      }\n\n      this.set('session_id', _.get(data, 'session_id'));\n\n      this.connectStore(ctx);\n      this.ctx = ctx;\n\n      this.set({ msg: { data } });\n      // update call state\n      this.setState({\n        msg: 'AdvisorVideoCall.ringingStatusTxt',\n        callState: VideoCallModel.CALL_STATES.videoCallConnecting,\n      });\n\n      return data;\n    } catch (err) {\n      console.log('create session error', err);\n      this.setState({\n        msg: { text: err.toString() },\n      });\n    }\n  }\n\n  async notifySession() {\n    console.log('@notifySession');\n    this.set({ stopNotifySession: false });\n    const msg = this.get('msg');\n\n    const notifId = _.get(msg, 'data.session_id');\n    this.set({ notifId, msg });\n    this.get('stream').emit('notify', msg);\n    this.watchNotifTimeout();\n  }\n\n  async stopNotifySession() {\n    this.set({ stopNotifySession: true });\n    this.get('stream').emit('stopNotify');\n  }\n\n  watchNotifTimeout() {\n    console.log('@watchNotifTimeout');\n    const notifId = this.get('notifId');\n    const watcherKey = `notifListener.${notifId}`;\n    if (!this.get(watcherKey)) {\n      const db = fibApp.getClient().firestore();\n\n      const docRef = db.collection('videocalls').doc(notifId);\n      const disposers = [];\n      disposers.push(\n        docRef.onSnapshot((docData) => {\n          const data = docData.data();\n          if (_.get(data, 'states.isNoAnswer')) {\n            this.stopNotifySession();\n          }\n        })\n      );\n\n      disposers.push(\n        this.get('stream').on('stopNotify', () => {\n          disposers.map((dis) => dis());\n          disposers.splice(0, disposers.length);\n        })\n      );\n      this.set(watcherKey, true);\n    }\n  }\n\n  /**\n   * handlers for VideoCallModel\n   *\n   * @memberof VideoCallModel\n   */\n  switchCamera() {\n    const cameraPositions = ['front', 'back'];\n    const cameraPosition = this.getState('cameraPosition');\n    const currIndex = _.indexOf(cameraPositions, cameraPosition);\n    const newPos = cameraPositions[(currIndex + 1) % cameraPositions.length];\n    this.setState('myState.cameraPosition', newPos);\n    this.setState({\n      cameraPosition: newPos,\n    });\n  }\n\n  toggleMic() {\n    this.setState('myState.micMute', !this.getState('myState.micMute'));\n  }\n\n  toggleVideo() {\n    this.setState('myState.videoMute', !this.getState('myState.videoMute'));\n  }\n\n  toggleVideoSubscriber() {\n    this.setState('remoteState.videoMute', !this.getState('remoteState.videoMute'));\n  }\n\n  collapseVideo() {\n    this.setState('myState.collapse', true);\n  }\n\n  separateVideo() {\n    this.setState('myState.collapse', false);\n  }\n\n  reConnecting() {\n    this.setState('myState.internetStatus', VideoCallModel.INTERNET_STATES.reconnecting);\n  }\n\n  reConnected() {\n    this.setState('myState.internetStatus', VideoCallModel.INTERNET_STATES.connected);\n  }\n\n  disConnected() {\n    if (this.getCallState() !== VideoCallModel.CALL_STATES.videoCallFinish) {\n      this.setState('myState.internetStatus', VideoCallModel.INTERNET_STATES.disconnect);\n    }\n  }\n\n  isConnected() {\n    return (\n      this.useState('myState.internetStatus') === VideoCallModel.INTERNET_STATES.connected\n      && this.useState('otherState.internetStatus') === VideoCallModel.INTERNET_STATES.connected\n    );\n  }\n\n  isConnecting() {\n    return (\n      this.useState('myState.internetStatus') === VideoCallModel.INTERNET_STATES.reconnecting\n      || this.useState('otherState.internetStatus') === VideoCallModel.INTERNET_STATES.reconnecting\n    );\n  }\n\n  isDisconnected() {\n    return this.useState('myState.internetStatus') === VideoCallModel.INTERNET_STATES.disconnect;\n  }\n\n  async startCall() {\n    this.setState({\n      callState: VideoCallModel.CALL_STATES.videoCallOnProgress,\n    });\n  }\n\n  takeCall() {\n    console.log('take the call, update state');\n    this.stopNotifySession();\n    this.setState({\n      callState: VideoCallModel.CALL_STATES.videoCallTaking,\n    });\n  }\n\n  startTimer() {\n    if (!this.getState('states.startTime')) {\n      this.setState('states.startTime', moment().valueOf());\n    }\n    this.setState({\n      startTime: moment(this.getState('states.startTime')),\n    });\n  }\n\n  endCall() {\n    if (\n      this.hasCallState(VideoCallModel.CALL_STATES.videoCallConnecting)\n      || this.hasCallState(VideoCallModel.CALL_STATES.videoCallIncomming)\n    ) {\n      this.setState('states.videoCallReject', true);\n      return;\n    }\n    this.setState('states.endTime', moment().valueOf());\n    this.setState('states.videoCallComplete', true);\n  }\n\n  startIncomingCall() {\n    this.setState({\n      callState: VideoCallModel.CALL_STATES.videoCallIncomming,\n    });\n  }\n\n  rejectCall() {\n    // try to go to previous screen\n    // routes.goBack();\n    this.setState('states.videoCallReject', true);\n  }\n\n  /**\n   * getter for VideoCallModel\n   *\n   * @returns\n   * @memberof VideoCallModel\n   */\n  getCallState() {\n    const callState = this.useState('callState');\n    console.log('---hasCallState', callState);\n    return callState;\n  }\n\n  hasCallState(state) {\n    return this.getCallState() === state;\n  }\n\n  getCallDuration() {\n    const startTime = this.useState('startTime');\n    if (!startTime) return '';\n\n    const now = moment();\n    const duration = moment.duration(now.diff(startTime));\n    return durationFormatter(duration.asMilliseconds());\n  }\n\n  getCallDurationTotal(format = 'MM') {\n    const startTime = this.getState('startTime');\n    const endTime = this.getState('endTime');\n    if (!startTime || !endTime) return '';\n\n    const duration = moment.duration(endTime.diff(startTime));\n    return durationFormatter(duration.asMilliseconds());\n  }\n\n  getCallMaxDuration() {\n    const msg = this.get('msg');\n    const durationSecondsStr = _.get(msg, 'data.session_duration');\n    const duration = moment.duration(durationSecondsStr, 'seconds');\n\n    return durationFormatter(duration.asMilliseconds());\n  }\n\n  static async onForegroundEvent(ev) {\n    const { type, detail } = ev;\n    if (type === EventType.ACTION_PRESS) {\n      const action = _.get(detail, 'pressAction.id');\n      const msg = _.get(detail, 'notification');\n      const instance = await VideoCallModel.fromMessage(msg);\n      if (instance) {\n        const handlers = instance.get('actions');\n        const handler = _.get(handlers, [action]);\n        if (_.isFunction(handler)) handler(msg);\n      }\n    }\n  }\n\n  static async onBackgroundEvent(ev) {\n    const { type, detail } = ev;\n    if (type === EventType.ACTION_PRESS) {\n      console.log('type, detail', type, detail.pressAction);\n    } else {\n      console.log('tyatyatya', type);\n    }\n  }\n}\n\n// graphme.model({ VideoCallModel });\n\nexport default VideoCallModel;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import { bindings, hook } from '@vl/redata';\nimport VideoCallModel from '@uz/unitz-models/VideoCallWebModel';\n\nconst bindData = bindings({\n  videoComponent: {\n    rules: [\n      [\n        'data',\n        {\n          data: {},\n        },\n      ],\n    ],\n  },\n  videoCallIniting: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallIniting)),\n        },\n      ],\n    ],\n  },\n  videoCallConnecting: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallConnecting)),\n        },\n      ],\n    ],\n  },\n  videoCallIncomming: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallIncomming)),\n        },\n      ],\n    ],\n  },\n  videoCallTaking: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallTaking)),\n        },\n      ],\n    ],\n  },\n  videoCallOnProgress: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallOnProgress)\n              && ctx.apply('videoCallModel.isConnected')\n          ),\n        },\n      ],\n    ],\n  },\n\n  videoCallOnProgressOffCamera: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallOnProgress)\n              && !(\n                ctx.apply('videoCallModel.useState', 'remoteState.videoMute') && ctx.apply('videoCallModel.isConnected')\n              )\n          ),\n        },\n      ],\n    ],\n  },\n\n  videoCallDisconnect: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallFinish)\n              && ctx.apply('videoCallModel.isDisconnected')\n          ),\n        },\n      ],\n    ],\n  },\n\n  sessionReconnect: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.isConnecting')),\n        },\n      ],\n    ],\n  },\n\n  callSession: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallFinish)),\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import React from 'react';\n\nimport DIV from '@vl/redata/DIV.macro';\n\nimport VideoCall from '@uz/unitz-components-web/VideoCall';\nimport { SectionVideoCallActions } from '@uz/unitz-components-web/VideoCall/components';\nimport { ctx } from '@vl/redata';\n\nconst Index = () => {\n  return (\n    <DIV className=\"videoPage\">\n      <div\n        ref={ctx.apply('LAYOUT.onLayout', 'AdvisorVideoCallStatus')}\n        className=\"fixed top-0 left-0 z-10 w-screen h-screen bg-main\"\n      >\n        <VideoCall />\n        <DIV className=\"sectionVideoActions\">\n          <SectionVideoCallActions />\n        </DIV>\n      </div>\n    </DIV>\n  );\n};\n\nexport default Index;\n","export const formatter = {\n  getTokboxConfig: () => (videoCallModel) => {\n    const state = {};\n    return {\n      apiKey: videoCallModel.getSectionKey(),\n      sessionId: videoCallModel.getSectionId(),\n      token: videoCallModel.getSectionToken(),\n\n      signal: {\n        data: 'data',\n        type: 'init',\n        to: '',\n      },\n      ref: (ref) => {\n        state.ref = ref;\n      },\n\n      eventHandlers: {\n        sessionConnected: (ev) => {\n          console.log('sessionConnected, caller', ev);\n        },\n        sessionDisconnected: (ev) => {\n          console.log('disconnected', ev, ev.connectionId);\n          videoCallModel.disConnected();\n        },\n        sessionReconnected: (ev) => {\n          console.log('sessionReconnected', ev);\n          videoCallModel.reConnected();\n        },\n        sessionReconnecting: (ev) => {\n          console.log('sessionReconnecting', ev);\n          videoCallModel.reConnecting();\n        },\n        streamCreated: (ev) => {\n          console.log('streamCreated', ev);\n          // videoCallModel.startCall();\n          // videoCallModel.startTimer();\n        },\n        streamDestroyed: (ev) => {\n          console.log('streamDestroyed', ev);\n        },\n        connectionCreated: (ev) => {\n          console.log('connectionCreated', ev.connectionId);\n          // videoCallModel.startCall();\n          // videoCallModel.startTimer();\n        },\n        connectionDestroyed: (ev) => {\n          console.log('connectionDestroyed', ev);\n          // videoCallModel.endCall();\n        },\n        signal: (ev) => {\n          console.log('ev', ev);\n        },\n      },\n    };\n  },\n\n  getTokboxSubscriberConfig: () => (videoCallModel) => {\n    return {\n      eventHandlers: {\n        videoDisabled: () => {\n          videoCallModel.toggleVideoSubscriber();\n        },\n        videoEnabled: () => {\n          videoCallModel.toggleVideoSubscriber();\n        },\n      },\n    };\n  },\n};\n\nexport default formatter;\n","import React from 'react';\nimport { bindings, hook } from '@vl/redata';\nimport _ from 'lodash';\nimport VideoCallModel from '@uz/unitz-models/VideoCallWebModel';\nimport VideoCallFormatter from '@uz/unitz-models/VideoCallWebModel/formatter';\nimport PurchaseModel from '@uz/unitz-models/PurchaseModel';\nimport AdvisorModel from '@uz/unitz-models/AdvisorModel';\nimport AdvisorProfileFormatter from '@uz/unitz-models/AdvisorProfileModel/formatter';\nimport CFAdvisorProfileFormatter from '@uz/unitz-models/CFAdvisorProfileModel/formatter';\nimport usePromiseSource from '@vl/hooks/usePromiseSource';\nimport { formatVND } from '@vl/mod-utils/currencyFormatter';\nimport useRoute from '@vl/hooks/useGbRoute';\n\nconst CONTROL_BAR_STATUS = ['hide', 'half', 'full'];\n\nconst bindData = bindings({\n  videoPage: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            '@params': hook((ctx) => {\n              const route = useRoute();\n              const routeParams = _.get(route, 'params', {});\n              const advisor_id = _.get(routeParams, 'id');\n              const service_id = _.get(routeParams, 'service_id', '');\n              const purchase_id = _.get(routeParams, 'purchase_id', '');\n              const user_id = ctx.apply('authModel.getUserId');\n              const callParams = {\n                advisor_id,\n                service_id,\n                user_id,\n                purchase_id,\n              };\n              return callParams;\n            }),\n\n            videoCallModel: hook((ctx) => {\n              const advisor_id = ctx.get('@params.advisor_id');\n              const videoCallModel = React.useMemo(() => {\n                const videoCallModel = VideoCallModel.fromCall(ctx.get('@params'), ctx);\n                videoCallModel.createSession(ctx);\n                return videoCallModel;\n                // eslint-disable-next-line\n              }, [advisor_id]);\n              videoCallModel.hookState();\n\n              // check call rejected\n              videoCallModel.useEffect(\n                () => {\n                  if (videoCallModel.getState('states.videoCallReject')) {\n                    ctx.apply('@page.onCompleted', 'rejected');\n                  }\n                },\n                () => [videoCallModel.getState('states.videoCallReject')]\n              );\n\n              // check call no answer\n              videoCallModel.useEffect(\n                () => {\n                  if (videoCallModel.getState('states.isNoAnswer')) {\n                    ctx.apply('@page.onCompleted', 'missed');\n                  }\n                },\n                () => [videoCallModel.getState('states.isNoAnswer')]\n              );\n\n              // check call finish\n              videoCallModel.useEffect(\n                () => {\n                  if (videoCallModel.hasCallState(VideoCallModel.CALL_STATES.videoCallFinish)) {\n                    ctx.apply('@page.onCompleted', 'completed');\n                  }\n                },\n                () => [videoCallModel.getCallState()]\n              );\n\n              return videoCallModel;\n            }),\n\n            tokbox: hook((ctx) => {\n              const voiceCallModel = ctx.get('videoCallModel');\n              const tokboxConfig = VideoCallFormatter.getTokboxConfig(ctx)(voiceCallModel);\n              return tokboxConfig;\n            }),\n\n            tokboxSubscriber: hook((ctx) => {\n              const voiceCallModel = ctx.get('videoCallModel');\n              const tokboxConfig = VideoCallFormatter.getTokboxSubscriberConfig(ctx)(voiceCallModel);\n              return tokboxConfig;\n            }),\n\n            '@items': hook((ctx) => {\n              const { advisor_id, service_id } = ctx.get('@params');\n\n              const advisor = usePromiseSource(\n                async () => {\n                  if (!advisor_id) return null;\n                  try {\n                    const profile = await AdvisorModel.find(\n                      `where: {id: {_eq:\"${advisor_id}\"}}`,\n                      `services(where: {id: {_eq: \"${service_id}\"}}) {\n                        price {\n                          per_unit\n                          per_amount\n                          price_currency\n                          price_amount\n                        \n                          \n                        }\n                        id\n                        service {\n                          id\n                          name\n                          \n                        }\n                      }\n                      profile {\n                        id\n                        display_name\n                        avatar_url\n                        created_at\n                      }\n                      reviews {\n                        id\n                        review_text\n                        score\n                        updated_at\n                        author {\n                          profile {\n                            avatar_url\n                            display_name\n                            id\n                          }\n                        }\n                      } review_agg {\n                        avg_score\n                      } `\n                    );\n                    return profile.toObject();\n                  } catch (err) {}\n                },\n                null,\n                [advisor_id]\n              );\n              // console.log({ advisor });\n              const item = _.get(advisor, '0');\n              const service = _.get(advisor, '0.services.0');\n              const advisorProfile = _.get(advisor, '0.profile');\n              return {\n                id: advisor_id,\n                service_id,\n                advisorProfile: {\n                  id: AdvisorProfileFormatter.profileId(ctx)(advisorProfile),\n                  displayName: AdvisorProfileFormatter.displayName(ctx)(advisorProfile),\n                  avatarUrl: AdvisorProfileFormatter.avatarUrl(ctx)(advisorProfile),\n                  rating: {\n                    ratingText: AdvisorProfileFormatter.reviewText(ctx)(item),\n                    ratingScore: AdvisorProfileFormatter.reviewScore(ctx)(item),\n                  },\n                  // createdAtTxt: AdvisorProfileFormatter.createdAt(ctx)(advisor),\n                },\n\n                price: {\n                  pricePerMinTxt: AdvisorProfileFormatter.pricePerMin(ctx)(service),\n                  pricePerMinTitle: AdvisorProfileFormatter.pricePerMinTitle(ctx)(service),\n                },\n              };\n            }),\n            isCalling: hook((ctx) => {\n              return ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallOnProgress);\n            }),\n            '@sectionActions': hook((ctx) => {\n              const [visibleDropdown, $visibleDropdown] = React.useState(false);\n              return {\n                visibleDropdown,\n                $visibleDropdown: (visible) => {\n                  $visibleDropdown(visible);\n                },\n              };\n            }),\n            smartGesture: hook((ctx) => {\n              const [controlBarStatus, $controlBarStatus] = React.useState('half');\n              const [swap, $swap] = React.useState(false);\n              const [dragging, $dragging] = React.useState(false);\n              return {\n                controlBarStatus,\n                swap,\n                dragging,\n                slideUp: () => {},\n                $touchScreen: () => {\n                  if (!dragging) {\n                    const index = _.findIndex(CONTROL_BAR_STATUS, (item) => controlBarStatus === item);\n                    if (CONTROL_BAR_STATUS[index + 1]) {\n                      $controlBarStatus(CONTROL_BAR_STATUS[index + 1]);\n                    } else {\n                      $controlBarStatus(CONTROL_BAR_STATUS[0]);\n                    }\n                  }\n                },\n                $touchSmallScreen: () => {\n                  if (!dragging) {\n                    $swap(!swap);\n                  }\n                },\n                onDrag: () => {\n                  $dragging(true);\n                },\n                onStopDrag: () => {\n                  setTimeout(() => {\n                    $dragging(false);\n                  }, 200);\n                },\n              };\n            }),\n            '@page': hook((ctx) => {\n              const route = useRoute();\n              return {\n                onCompleted: (status) => {\n                  const videoCallModel = ctx.get('videoCallModel');\n                  const session_id = videoCallModel.getSectionId();\n                  const { purchase_id, advisor_id } = ctx.get('@params');\n                  const params = {\n                    advisor_id,\n                    purchase_id,\n                    session_id,\n                    step: 'completed',\n                    status: status || 'completed',\n                  };\n                  // Change URL\n                  const toUrl = route.redirectUrl(params, { origin: false });\n                  route.navigate(toUrl, {\n                    relace: true,\n                    state: { purchase_id },\n                  });\n                  // Change Step\n                  route.setRouteState(params);\n                  ctx.apply('stepModel.setStep', params.step);\n                },\n              };\n            }),\n            purchaseData: hook((ctx) => {\n              const { purchase_id } = ctx.get('@params');\n              const purchaseData = usePromiseSource(\n                async () => {\n                  if (!purchase_id) return null;\n                  try {\n                    const purchase = await PurchaseModel.find(\n                      `where: {id: {_eq: \"${purchase_id}\"}}`,\n                      `\n                      services {\n                        id\n                        price_amount\n                      }\n                      discounts {\n                        currency\n                        percentage\n                        amount\n                        id\n                        type\n                      }\n                      `\n                    );\n                    return purchase.toObject();\n                  } catch (err) {}\n                },\n                null,\n                [purchase_id]\n              );\n              const bill = CFAdvisorProfileFormatter.amountPayment(ctx)({\n                price: { price_amount: _.get(purchaseData, '0.services.0.price_amount') },\n                discounts: _.get(purchaseData, '0.discounts'),\n              });\n              return {\n                totalAfter: _.get(bill, 'totalAfter') ? formatVND(_.get(bill, 'totalAfter')) : 0,\n                totalBefore: _.get(bill, 'totalBefore') ? formatVND(_.get(bill, 'totalBefore')) : 0,\n                discount: _.get(bill, 'discount') ? formatVND(_.get(bill, 'discount')) : 0,\n              };\n            }),\n          },\n        },\n      ],\n    ],\n  },\n  sectionVideoActions: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => {\n            return (\n              true\n              || ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallConnecting)\n              || ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallOnProgress)\n            );\n          }),\n        },\n      ],\n    ],\n  },\n  videoCallFinish: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('videoCallModel.hasCallState', VideoCallModel.CALL_STATES.videoCallFinish)),\n        },\n      ],\n      [\n        'data',\n        {\n          data: {},\n        },\n      ],\n    ],\n  },\n  isLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n  notLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import React from 'react';\n\nimport DIV from '@vl/redata/DIV.macro';\nimport CallCompleted from '@uz/unitz-pages/CallCompleted';\nimport VideoPage from '@uz/unitz-pages/VideoCall';\nimport PaymentPage from '@uz/unitz-pages/Payment';\nimport PaymentConfirm from '@uz/unitz-pages/PaymentConfirm';\nimport { UnAuthRedirect } from '@uz/unitz-components-web/AppRedirect';\nimport { ctx } from '@vl/redata';\n\nconst Index = () => {\n  return (\n    <DIV>\n      <UnAuthRedirect to={ctx.apply('authModel.generateLoginRedirectUrl')}>\n        <DIV className=\"serviceSessionPage\">\n          <DIV className=\"paymentStep\">\n            <PaymentPage />\n          </DIV>\n          <DIV className=\"confirmStep\">\n            <PaymentConfirm />\n          </DIV>\n          <DIV className=\"serviceStep\">\n            <VideoPage />\n          </DIV>\n          <DIV className=\"completedStep\">\n            <CallCompleted />\n          </DIV>\n        </DIV>\n      </UnAuthRedirect>\n    </DIV>\n  );\n};\n\nexport default Index;\n","import React from 'react';\nimport { bindings, hook } from '@vl/redata';\n\nimport _ from 'lodash';\nimport useRoute from '@vl/hooks/useGbRoute';\n\nconst STEP_LIST = ['payment', 'confirm', 'cancel', 'service', 'completed'];\n\nconst STEP_LIST_BY_NAME = {};\n_.map(STEP_LIST, (val, index) => (STEP_LIST_BY_NAME[val] = index));\n\nconst bindData = bindings({\n  serviceSessionPage: {\n    rules: [\n      [\n        'data',\n        {\n          data: {\n            stepModel: hook((ctx) => {\n              const route = useRoute();\n              const routeParams = _.get(route, 'params', {});\n              const step = _.get(routeParams, 'step', _.first(STEP_LIST));\n\n              const [currentStep, $currentStep] = React.useState(step);\n              React.useEffect(() => {\n                if (currentStep !== step) {\n                  $currentStep(step);\n                }\n              }, [currentStep, $currentStep, step]);\n\n              return {\n                currentStep,\n                setStep: (newStep) => _.has(STEP_LIST_BY_NAME, newStep) && $currentStep(newStep),\n                hasNext: () => {},\n                nextStep: () => {},\n                prevStep: () => {},\n                handlers: {\n                  callAgain: () => {\n                    const params = {\n                      step: 'confirm',\n                      status: undefined,\n                    };\n                    // Change URL\n                    const toUrl = route.redirectUrl(params, { origin: false });\n                    route.navigate(toUrl, {\n                      relace: true,\n                    });\n                    // Change Step\n                    route.setRouteState(params);\n                    ctx.apply('stepModel.setStep', params.step);\n                  },\n                  callFinish: () => {\n                    // Change URL\n                    const toUrl = ctx.apply('routeStore.toUrl', 'advisor', routeParams);\n                    route.navigateExternal(toUrl);\n                  },\n                },\n              };\n            }),\n          },\n        },\n      ],\n    ],\n  },\n  paymentStep: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.get('stepModel.currentStep') === STEP_LIST[0]),\n        },\n      ],\n    ],\n  },\n  confirmStep: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => _.get(useRoute(), 'params.purchase_id') && ctx.get('stepModel.currentStep') === STEP_LIST[1]\n          ),\n        },\n      ],\n    ],\n  },\n  serviceStep: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => _.get(useRoute(), 'params.purchase_id') && ctx.get('stepModel.currentStep') === STEP_LIST[3]\n          ),\n        },\n      ],\n    ],\n  },\n  completedStep: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook(\n            (ctx) => _.get(useRoute(), 'params.purchase_id') && ctx.get('stepModel.currentStep') === STEP_LIST[4]\n          ),\n        },\n      ],\n    ],\n  },\n  isLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n  notLoading: {\n    rules: [\n      [\n        'display',\n        {\n          display: hook((ctx) => !ctx.apply('loadingModel.isLoading')),\n        },\n      ],\n    ],\n  },\n});\n\nexport default bindData;\n","import View from './View.js';\nimport Data from './Data.js';\n\nexport default Data(View);\n","import React from 'react';\n\nimport { ctx } from '@vl/redata';\nimport DIV from '@vl/redata/DIV.macro';\n\nimport App from '@uz/unitz-app-web/UserApp';\nimport SEO from '@uz/unitz-layout-web/SEO';\nimport ServiceSession from '@uz/unitz-pages/ServiceSession';\n\nimport Layout from '@uz/unitz-layout-web/LayoutMain';\nimport withPageContext from '@uz/unitz-pages/withPageContext';\n\nimport PageData from '../../data/PageDataQuery';\n\nexport const component = withPageContext((props) => {\n  return (\n    <App>\n      <Layout location={props.location} PageData={PageData}>\n        <DIV>\n          <SEO pageData={ctx.apply('ctf.findPage', { name: 'Homepage' })} />\n          <Layout.POS name=\"app-header\">{ctx.apply('ctf.renderSection', { name: 'articleNavbarSection' })}</Layout.POS>\n          <Layout.POS name=\"app-body\">\n            <div className=\"wrapper app-row\">\n              <div className=\"relative overflow-hidden\">\n                <ServiceSession />\n              </div>\n            </div>\n          </Layout.POS>\n          <Layout.POS name=\"app-footer\">{ctx.apply('ctf.renderSection', { name: 'articleFooterSection' })}</Layout.POS>\n        </DIV>\n      </Layout>\n    </App>\n  );\n});\n\nexport default component;\n"],"sourceRoot":""}